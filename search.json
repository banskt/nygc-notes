[
  {
    "objectID": "code/2023-05-23-macos-setup.html",
    "href": "code/2023-05-23-macos-setup.html",
    "title": "Setup MacOS",
    "section": "",
    "text": "Running documentation for the MacOS setup in Janaki."
  },
  {
    "objectID": "code/2023-05-23-macos-setup.html#bash",
    "href": "code/2023-05-23-macos-setup.html#bash",
    "title": "Setup MacOS",
    "section": "Bash",
    "text": "Bash\n\nInstall bash version 5.2.15(1) using homebrew following instructions in this blog post. However, I could not create the Symlink by disabling SIP (csrutil disable).\nThe pre-installed old bash still exists in /bin/bash. Therefore, I have to write bash scripts using #!/usr/bin/env bash.\nUpdate my dotfiles for Mac specific utilities."
  },
  {
    "objectID": "code/2023-05-23-macos-setup.html#homebrew",
    "href": "code/2023-05-23-macos-setup.html#homebrew",
    "title": "Setup MacOS",
    "section": "Homebrew",
    "text": "Homebrew\n\nWhy don’t they ship this package manager as default in MacOS?"
  },
  {
    "objectID": "code/2023-05-23-macos-setup.html#terminal",
    "href": "code/2023-05-23-macos-setup.html#terminal",
    "title": "Setup MacOS",
    "section": "Terminal",
    "text": "Terminal\n\nThe default terminal in Mac does not support 24 bit color, and many other Unix features which I use regularly (for example, middle click paste).\nInstall iterm2 using homebrew\n\nbrew install --cask iterm2"
  },
  {
    "objectID": "code/2023-05-23-macos-setup.html#latex",
    "href": "code/2023-05-23-macos-setup.html#latex",
    "title": "Setup MacOS",
    "section": "Latex",
    "text": "Latex\n\nI do not want the GUI packages of MacTex, but I want full TexLive.\nFor a finer control over TexLive, I decided to clone the TexLive repository and install from there.\n\nbrew install wget\nmkdir -p /opt/texlive-repository\nchown -R sbanerjee:staff /opt/texlive-repository\nupdate-texlive-repository /opt/texlive-repository # this is an alias to clone the repository, takes couple of hours\n\nFinally, install TexLive from the repository"
  },
  {
    "objectID": "code/2023-05-23-macos-setup.html#gcc-gfortran",
    "href": "code/2023-05-23-macos-setup.html#gcc-gfortran",
    "title": "Setup MacOS",
    "section": "gcc / gfortran",
    "text": "gcc / gfortran\n\nJust install with Homebrew.\n\nbrew info gcc\nbrew install gcc"
  },
  {
    "objectID": "code/2023-05-23-macos-setup.html#r",
    "href": "code/2023-05-23-macos-setup.html#r",
    "title": "Setup MacOS",
    "section": "R",
    "text": "R\n\nRequires gfortran, TeX, tcltk\nInstall using pkg file provided by R."
  },
  {
    "objectID": "code/2023-05-23-macos-setup.html#python",
    "href": "code/2023-05-23-macos-setup.html#python",
    "title": "Setup MacOS",
    "section": "Python",
    "text": "Python\nbrew install micromamba\nmicromamba shell -s bash -p /opt/micromamba -vvv init\nThis will install micromamba and choose /opt/micromamba as the root prefix. Sample output:\nModifying RC file \"/Users/sbanerjee/.bash_profile\"\nGenerating config for root prefix \"/opt/micromamba\"\nSetting mamba executable to: \"/usr/local/bin/micromamba\"\nAdding (or replacing) the following in your \"/Users/sbanerjee/.bash_profile\" file\n\n# &gt;&gt;&gt; mamba initialize &gt;&gt;&gt;\n# !! Contents within this block are managed by 'mamba init' !!\nexport MAMBA_EXE=\"/usr/local/bin/micromamba\";\nexport MAMBA_ROOT_PREFIX=\"/opt/micromamba\";\n__mamba_setup=\"$(\"$MAMBA_EXE\" shell hook --shell bash --prefix \"$MAMBA_ROOT_PREFIX\" 2&gt; /dev/null)\"\nif [ $? -eq 0 ]; then\n    eval \"$__mamba_setup\"\nelse\n    if [ -f \"/opt/micromamba/etc/profile.d/micromamba.sh\" ]; then\n        . \"/opt/micromamba/etc/profile.d/micromamba.sh\"\n    else\n        export  PATH=\"/opt/micromamba/bin:$PATH\"  # extra space after export prevents interference from conda init\n    fi\nfi\nunset __mamba_setup\n# &lt;&lt;&lt; mamba initialize &lt;&lt;&lt;\nNote. I deleted these initialization scripts from .bash_profile and added them to ~/.custom_dotfiles/bashrc because that is my preferred bash configuration file.\nInstalled Python environment and changed the repository to conda-forge using ~/.mambarc\nmicromamba create --name py311 python=3.11 -c conda-forge"
  },
  {
    "objectID": "code/2023-05-23-macos-setup.html#quarto",
    "href": "code/2023-05-23-macos-setup.html#quarto",
    "title": "Setup MacOS",
    "section": "Quarto",
    "text": "Quarto\n\nUse .dmg file to install Quarto."
  },
  {
    "objectID": "code/2023-05-23-macos-setup.html#vim",
    "href": "code/2023-05-23-macos-setup.html#vim",
    "title": "Setup MacOS",
    "section": "Vim",
    "text": "Vim\n\nBash syntax highlighting was broken in Vim shipped by Macbook - see issue here. I installed latest vim using Homebrew."
  },
  {
    "objectID": "code/2023-04-25-cluster-setup.html",
    "href": "code/2023-04-25-cluster-setup.html",
    "title": "Setup Python workbench",
    "section": "",
    "text": "Here is a short documentation for the setup of my home at the NYGC cluster. I started by cloning my dotfiles from GitHub."
  },
  {
    "objectID": "code/2023-04-25-cluster-setup.html#directory-structure",
    "href": "code/2023-04-25-cluster-setup.html#directory-structure",
    "title": "Setup Python workbench",
    "section": "Directory structure",
    "text": "Directory structure\n\nopt for installing software\nsoftware for downloading and/or developing software\nwork for experiments / simulations / analysis"
  },
  {
    "objectID": "code/2023-04-25-cluster-setup.html#setup-modules",
    "href": "code/2023-04-25-cluster-setup.html#setup-modules",
    "title": "Setup Python workbench",
    "section": "Setup modules",
    "text": "Setup modules\n\nAdd export MODULEPATH=\"${MODULEPATH}:${HOME}/modulefiles\" to include personal modulefiles."
  },
  {
    "objectID": "code/2023-04-25-cluster-setup.html#setup-miniconda",
    "href": "code/2023-04-25-cluster-setup.html#setup-miniconda",
    "title": "Setup Python workbench",
    "section": "Setup Miniconda",
    "text": "Setup Miniconda\n\nDownload and install latest version of Miniconda (23.3.1).\nCopy conda init script from .bashrc to opt/miniconda3/conda_bash_init.sh.\nCreate a modulefile to initialize conda on demand. Similar issue for LMOD modulefiles.\n\n#%Module2.1.10#####################################################################\n##\n## modulefiles conda/23.3.1\n##\n\nset version 23.3.1\nset modroot /gpfs/commons/home/sbanerjee/opt/miniconda3\n\nproc ModulesHelp { } {\n        global version modroot\n        puts stderr \"conda/$version - adds Miniconda to PATH\"\n}\n\nmodule-whatis   \"Sets the environment for using Miniconda\"\n\n# Only one version at a time\nconflict conda\n\nif [module-info mode load] {\n    puts stdout \"source $modroot/conda_bash_init.sh ;\"\n}\n\nif [module-info mode remove] {\n    puts stdout \"conda deactivate ;\"\n    remove-path PATH $modroot/bin\n    remove-path PATH $modroot/condabin\n\n    ## unset variable names.\n    ## env | grep \"CONDA\"\n    unsetenv CONDA_SHLVL\n    unsetenv CONDA_EXE\n    unsetenv _CE_CONDA\n    unsetenv CONDA_PYTHON_EXE\n\n    ## unset function names\n    ## declare -F\n    unsetenv __conda_activate\n    unsetenv __conda_exe\n    unsetenv __conda_hashr\n    unsetenv __conda_reactivate\n    unsetenv conda\n}\n\nSetup .condarc (see dotfiles)"
  },
  {
    "objectID": "code/2023-04-25-cluster-setup.html#install-python",
    "href": "code/2023-04-25-cluster-setup.html#install-python",
    "title": "Setup Python workbench",
    "section": "Install Python",
    "text": "Install Python\nmodule load gcc/11.2.0 lapack/3.10 openmpi/4.1.4\nconda create --name py311 python=3.11 -c conda-forge\nconda activate py311\nconda config --env --add channels conda-forge\nconda install numpy scipy pandas scikit-learn matplotlib\nconda install jupyterlab"
  },
  {
    "objectID": "code/2023-04-25-cluster-setup.html#connect-to-jupyterlab",
    "href": "code/2023-04-25-cluster-setup.html#connect-to-jupyterlab",
    "title": "Setup Python workbench",
    "section": "Connect to JupyterLab",
    "text": "Connect to JupyterLab\nmkdir ~/.jupyter\ncp /nfs/sw/jupyter3/jupyter3-4.1/.jupyter/jupyter_notebook_config.py ~/.jupyter/jupyter_notebook_config.py\njupyter lab\nThere is no need for local port forwarding. (I want to know how it is set up, ask NYGC Cluster Linux help)."
  },
  {
    "objectID": "code/2023-04-25-cluster-setup.html#load-r-libraries-with-python",
    "href": "code/2023-04-25-cluster-setup.html#load-r-libraries-with-python",
    "title": "Setup Python workbench",
    "section": "Load R libraries with Python",
    "text": "Load R libraries with Python\n\nSet CXX17 path for compiling R packages\n\necho 'CXX17 = g++ -std=gnu++17 -fPIC' &gt; ~/.R/Makevars\n\nCreate modulefile for loading environment variables (required for loading R from Python) which are not set by NYGC.\n\n#%Module2.1.10#####################################################################\n##\n## modulefiles Renv/4.2.3\n##\n\nprereq R/4.2.3\n\nset version 4.2.3\nset rhome $::env(rhome)\n\nproc ModulesHelp { } {\n    global version\n    puts stderr \"Renv/$version - adds extra environment variables not provided by NYGC\"\n}\n\nmodule-whatis \"Sets the environment for using R/$version\"\n\n# Only one version at a time\nconflict Renv\n\nprepend-path    LIBRARY_PATH            $rhome/lib64/R/lib\nprepend-path    CPATH                   $rhome/lib64/R/include\nprepend-path    CMAKE_PREFIX_PATH       $rhome/\nsetenv          R_ROOT                  $rhome\nsetenv          R_HOME                  $rhome/lib64/R\n\nLoad the R module and the environment variables\n\nmodule load R/4.2.3\nmodule load Renv/4.2.3\n\nInstall some R packages (also checks that gcc is working)\n\nparallel::detectCores()\noptions(Ncpus = 48)\ninstall.packages(c(\"devtools\", \"ggplot2\"))\n\nInstall and verify rpy2\n\nconda install tzlocal # other dependencies are already installed while installing the previous packages\npip install rpy2\npython -m rpy2.situation\npython\n&gt;&gt; import rpy2.robjects as robj"
  },
  {
    "objectID": "code/index.html",
    "href": "code/index.html",
    "title": "Code",
    "section": "",
    "text": "In this section, I keep code snippets."
  },
  {
    "objectID": "listen/seminar/2023-06-29-gunnar-ratsch.html",
    "href": "listen/seminar/2023-06-29-gunnar-ratsch.html",
    "title": "Gunnar Ratsch, Multi-omics Analyses",
    "section": "",
    "text": "240 patients, melanoma. Health records, pathology, NGS, cfDNA, bulk RNA, drug testing, single cell genomics and transcriptomics, cfDNA, etc \\(\\rightarrow\\) data integration \\(\\rightarrow\\) molecular research report \\(\\rightarrow\\) summary \\(\\rightarrow\\) decision \\(\\rightarrow\\) treatment\nMulti-omics treatment suggestions improved overall treatment outcome (?) No randomized trial.\nChallenges:\n\nPredict protein abundance from cell morphology.\nSingle-cell integration via deep learning and matching.\nModeling in-vitro single-cell drug responses. They measure in vitro treatment response on many cells. Can they predict their response in advance for new cells, new patients, new drugs?\nMeasuring a cell destroys it, cannot measure same cell before and after treatment. Can you predict cells after perturbation? Primal Optimal transport problem. Dual formulation. Brenier’s Theorem. CellOT. Bunne, Stark et al, Nature Methods, 2023.\n\n\n\n\nMetagraph framework\n\ngiven raw sequencing data from thousands of experiments\nassemble clean graphs for each experiment\nintegrate into joint graph index\nlink to informative metadata (experiment, organism, clinical data, etc.)\nBinary relation wavelet trees (BRWT) Use \\(k = 1\\) to obtain."
  },
  {
    "objectID": "listen/seminar/2023-06-29-gunnar-ratsch.html#gunnar-ratsch-eth-zurich",
    "href": "listen/seminar/2023-06-29-gunnar-ratsch.html#gunnar-ratsch-eth-zurich",
    "title": "Gunnar Ratsch, Multi-omics Analyses",
    "section": "",
    "text": "240 patients, melanoma. Health records, pathology, NGS, cfDNA, bulk RNA, drug testing, single cell genomics and transcriptomics, cfDNA, etc \\(\\rightarrow\\) data integration \\(\\rightarrow\\) molecular research report \\(\\rightarrow\\) summary \\(\\rightarrow\\) decision \\(\\rightarrow\\) treatment\nMulti-omics treatment suggestions improved overall treatment outcome (?) No randomized trial.\nChallenges:\n\nPredict protein abundance from cell morphology.\nSingle-cell integration via deep learning and matching.\nModeling in-vitro single-cell drug responses. They measure in vitro treatment response on many cells. Can they predict their response in advance for new cells, new patients, new drugs?\nMeasuring a cell destroys it, cannot measure same cell before and after treatment. Can you predict cells after perturbation? Primal Optimal transport problem. Dual formulation. Brenier’s Theorem. CellOT. Bunne, Stark et al, Nature Methods, 2023.\n\n\n\n\nMetagraph framework\n\ngiven raw sequencing data from thousands of experiments\nassemble clean graphs for each experiment\nintegrate into joint graph index\nlink to informative metadata (experiment, organism, clinical data, etc.)\nBinary relation wavelet trees (BRWT) Use \\(k = 1\\) to obtain."
  },
  {
    "objectID": "listen/seminar/2023-07-25-peter-visscher.html",
    "href": "listen/seminar/2023-07-25-peter-visscher.html",
    "title": "Tajurba",
    "section": "",
    "text": "Height is a model trait in human genetics. One of the first studies was in 1886 Galton. Resemblance between relatives\nRA Fisher (1918) – foundation of quantitative genetics. Also ANOVA, and assortative mating, and dominant effects!\nWhat do we gain by ever-increasing experimental sample sizes, in terms of discovery, variance and prediction accuracy?"
  },
  {
    "objectID": "listen/group-meeting/2023-09-18-scott-adamson.html",
    "href": "listen/group-meeting/2023-09-18-scott-adamson.html",
    "title": "2023-09-18",
    "section": "",
    "text": "Pre-mRNA splicing can be important in interpreting functional interpretation of GWAS associations.\n\n\n\nAim 1. Use colocalization / ML predictions to find splicing relevant variants in GWAS associated variants of hematological phenotype. (sQTLs, SpliceAI high delta score, RNAprot high delta score)\nAim 2. Assay effects on splicing. CRiSPR based editing \\(\\rightarrow\\) scRNA-seq library \\(\\rightarrow\\) hybrid capture of specific junctions and gRNAs \\(\\rightarrow\\) identify splice-altering variants \\(\\rightarrow\\) validation of splice-altering variants on isoforms with ONT and mass spectrometry.\n\n\n\n\nHow many cells? How many guides? How good the editing needs to be done?\nPopulation scale scRNA-seq enables discovery of cell type specific eQTLs. Also see splatPOP – scRNA-seq simulation. How to simulate scRNA-seq sQTL?\nScott used simulations to identify and implement reasonable default parameters, e,g. read count parameters, transcript-end read bias, technology specificity.\n\n\n\nScott also developed a method for measuring editing efficiency."
  },
  {
    "objectID": "listen/group-meeting/2023-09-18-scott-adamson.html#presentation-by-scott-adamson",
    "href": "listen/group-meeting/2023-09-18-scott-adamson.html#presentation-by-scott-adamson",
    "title": "2023-09-18",
    "section": "",
    "text": "Pre-mRNA splicing can be important in interpreting functional interpretation of GWAS associations.\n\n\n\nAim 1. Use colocalization / ML predictions to find splicing relevant variants in GWAS associated variants of hematological phenotype. (sQTLs, SpliceAI high delta score, RNAprot high delta score)\nAim 2. Assay effects on splicing. CRiSPR based editing \\(\\rightarrow\\) scRNA-seq library \\(\\rightarrow\\) hybrid capture of specific junctions and gRNAs \\(\\rightarrow\\) identify splice-altering variants \\(\\rightarrow\\) validation of splice-altering variants on isoforms with ONT and mass spectrometry.\n\n\n\n\nHow many cells? How many guides? How good the editing needs to be done?\nPopulation scale scRNA-seq enables discovery of cell type specific eQTLs. Also see splatPOP – scRNA-seq simulation. How to simulate scRNA-seq sQTL?\nScott used simulations to identify and implement reasonable default parameters, e,g. read count parameters, transcript-end read bias, technology specificity.\n\n\n\nScott also developed a method for measuring editing efficiency."
  },
  {
    "objectID": "listen/group-meeting/2023-09-13-izzy-grabski.html",
    "href": "listen/group-meeting/2023-09-13-izzy-grabski.html",
    "title": "2023-09-13",
    "section": "",
    "text": "In scRNA-seq, we want to learn differential expression between two biological conditions. What are the causal drivers as opposed to secondary correlated genes? Genetic perturbation screens can help: knock down using CRISPR and understand the effects of knocked down genes: deconvolute the differences in terms of perturbations.\n\\(\\mathbf{D}_0\\): baseline condition. \\(\\mathbf{D}_1\\): list of perturbations that have taken place.\n\\[\\mathbf{Y}_0 = \\Phi f_0 + \\mathbf{E}_0\\] \\[\\mathbf{Y}_k = \\Phi f_k + \\Lambda_k \\mathbf{I}_k + \\mathbf{E}_k\\]\nCPA-Perturb-seq: perturb the same locations across multiple cells. The target is to find which cells are perturbed. This can be done in different cell lines (e.g. HEK and K562). The idea is to learn the \\(\\Lambda\\) for different cell lines and perform regression,\n\nWhat is the relation between \\(\\mathbf{D}\\) and \\(\\mathbf{Y}\\)?\nIs the noise Gaussian in the gene expression model?\nInstead of constraining \\(\\delta\\), what happens if we try learning \\(\\Lambda\\) from \\(\\mathbf{Y}_k - \\mathbf{Y}_0\\)?"
  },
  {
    "objectID": "listen/group-meeting/2023-09-13-izzy-grabski.html#presentation-by-izzy-grabski",
    "href": "listen/group-meeting/2023-09-13-izzy-grabski.html#presentation-by-izzy-grabski",
    "title": "2023-09-13",
    "section": "",
    "text": "In scRNA-seq, we want to learn differential expression between two biological conditions. What are the causal drivers as opposed to secondary correlated genes? Genetic perturbation screens can help: knock down using CRISPR and understand the effects of knocked down genes: deconvolute the differences in terms of perturbations.\n\\(\\mathbf{D}_0\\): baseline condition. \\(\\mathbf{D}_1\\): list of perturbations that have taken place.\n\\[\\mathbf{Y}_0 = \\Phi f_0 + \\mathbf{E}_0\\] \\[\\mathbf{Y}_k = \\Phi f_k + \\Lambda_k \\mathbf{I}_k + \\mathbf{E}_k\\]\nCPA-Perturb-seq: perturb the same locations across multiple cells. The target is to find which cells are perturbed. This can be done in different cell lines (e.g. HEK and K562). The idea is to learn the \\(\\Lambda\\) for different cell lines and perform regression,\n\nWhat is the relation between \\(\\mathbf{D}\\) and \\(\\mathbf{Y}\\)?\nIs the noise Gaussian in the gene expression model?\nInstead of constraining \\(\\delta\\), what happens if we try learning \\(\\Lambda\\) from \\(\\mathbf{Y}_k - \\mathbf{Y}_0\\)?"
  },
  {
    "objectID": "listen/group-meeting/2023-08-16-karin.html",
    "href": "listen/group-meeting/2023-08-16-karin.html",
    "title": "2023-08-16",
    "section": "",
    "text": "Is splicing bimodal in cells? Cells with more reads often have better range. What influences the observed splicing output? Cell size, single cell vs single nuclei, transcription rate (?), etc.\n~4500 captured RNAs, ~1500-2400 captured genes in PBMC by different sequencing tools.\nSmart-seq2: improved coverage, high level of mappable reads, higher sensitivity disadvantages: no early multiplexing, transcript length bias, lower throughput.\nSplit-seq: Higher throughput, improved coverage, lower cost, disadvantages: reduced sensitivity, less comprehensive alternative splicing information than full-length transcript methods.\nSmart-seq3xpress: scalable single-cell RNA sequencing from full trnscripts. Is it possible to get high sensitivity and high throughput?\n\n\n\nSplice junctions can be used for quantifying splicing. In the mouse reference, most junctions are “common” and found in all transcript isoforms for a given gene. In human, many more partially and fully unique junctions compared to mouse.\nSplit reads quantify presence or absence of intron cluster.\n\nTabula Muris dataset: Smart-seq + 10x sequencing on different cells in mouse. In bulk sample, 85,439 SJ before clustering, 9,390 after clustering. In pseudo-bulk sample (n = 432 cells), 101,801 SJ before clustering, 14,351 after clustering. In single cell, 9,731 before clustering, 481 after clustering.\nSplicing events: - Skipping exon - Mutually exclusive exons - Alternative 5’ splice site - Alternative 3’ splice site - Retained intron - First exon - Last exon\nHow do you know the splice event from the PSI value?\n\n\n\nInput: BAM file (pseudobulk if single cells) Model: Binomial Mixture Model, Inference with CAVI. Output: Optimal K (# cell states), Proportion of each cell state in the data, junction usage values for each cell state (PSI), cell state labels for each cell (Z).\nCell states inferred by Leaflet overlaps with FACS classification in the data."
  },
  {
    "objectID": "listen/group-meeting/2023-08-16-karin.html#presentation-by-karin-isaev",
    "href": "listen/group-meeting/2023-08-16-karin.html#presentation-by-karin-isaev",
    "title": "2023-08-16",
    "section": "",
    "text": "Is splicing bimodal in cells? Cells with more reads often have better range. What influences the observed splicing output? Cell size, single cell vs single nuclei, transcription rate (?), etc.\n~4500 captured RNAs, ~1500-2400 captured genes in PBMC by different sequencing tools.\nSmart-seq2: improved coverage, high level of mappable reads, higher sensitivity disadvantages: no early multiplexing, transcript length bias, lower throughput.\nSplit-seq: Higher throughput, improved coverage, lower cost, disadvantages: reduced sensitivity, less comprehensive alternative splicing information than full-length transcript methods.\nSmart-seq3xpress: scalable single-cell RNA sequencing from full trnscripts. Is it possible to get high sensitivity and high throughput?\n\n\n\nSplice junctions can be used for quantifying splicing. In the mouse reference, most junctions are “common” and found in all transcript isoforms for a given gene. In human, many more partially and fully unique junctions compared to mouse.\nSplit reads quantify presence or absence of intron cluster.\n\nTabula Muris dataset: Smart-seq + 10x sequencing on different cells in mouse. In bulk sample, 85,439 SJ before clustering, 9,390 after clustering. In pseudo-bulk sample (n = 432 cells), 101,801 SJ before clustering, 14,351 after clustering. In single cell, 9,731 before clustering, 481 after clustering.\nSplicing events: - Skipping exon - Mutually exclusive exons - Alternative 5’ splice site - Alternative 3’ splice site - Retained intron - First exon - Last exon\nHow do you know the splice event from the PSI value?\n\n\n\nInput: BAM file (pseudobulk if single cells) Model: Binomial Mixture Model, Inference with CAVI. Output: Optimal K (# cell states), Proportion of each cell state in the data, junction usage values for each cell state (PSI), cell state labels for each cell (Z).\nCell states inferred by Leaflet overlaps with FACS classification in the data."
  },
  {
    "objectID": "listen/group-meeting/2023-06-21-chirag-lakhani.html",
    "href": "listen/group-meeting/2023-06-21-chirag-lakhani.html",
    "title": "2023-06-21",
    "section": "",
    "text": "Apply DL to predict and interpret the functional effects of AD-associated variants on DNA regulation and RNA processing. How are they linked to pathways and networks?\n\nAD is a polygenic disease.\nLatest GWAS: Bellenguez et al, Nature Genetics, 2022\nControversy - drugs focus on particular pathways, but some kind of fails, expensive.\n\nCategories of pathogenic variants:\n\ncoding variants\ntranscriptional variants (need to know causal cell types) - disrupt TF binding (cell-type specific enhancers/promoter) - modify “epigenome” of a cell type (chromatin accessibility, histone modifications, 3D architecture - differential topology - via disrupting CTCF?)\npost-transcriptional variants (splicing, other activity)\n\nFunctional annotations help in finding molecular features that best explain a polygenic trait. Cano-Gomez et al, Frontier in Genetics, 2020.\nIdea: Use DL delta scores to predict the functional effect of any variant. Input: nucleotide sequence + (DeepSEA: chromatin, SpliceAI: splicing, etc) \\(\\rightarrow\\) Delta score: functional importance.\nMicroglia regulatory regions contain largest percentage of AD GWAS heritability.\nWays to construct DL delta score annotations:\n\nIntegrate DL-based TF binding disruption scores with cell-type specific regulatory genomic regions. – Enformer model trained on ENCODE cell types (K562, HepG2, etc) – use epigenomic data from neuronal cell types.\nTrain DL models predicting cell-type specific assay read counts as a function of genomic DNA sequence – functional genomic assays like ATAC-Seq, H3K27ac and H3K4me3 – cell types microglia, astrocytes, oligodendrocytes and neuron – access to microglia ATAC-Seq data\n\nEnformer: predicts 1000s of functional genomic assays from long input sequence (~200kb). Input: DNA sequence \\(\\rightarrow\\) convolution + transformation layes on human + mouse tracks \\(\\rightarrow\\) Output: genomic tracks. Avsec et al, Nature Methods, 2021\nOverlap regions of predicted TF disruption with promoter/enhancer regions. Enformer predicted TF disruption help localize AD GWAS signal.\nDL models can help finemapping.\n\n\n\n\nMulti-task DL model using chromatin accessibility data from 4 individuals. DNA sequence \\(\\rightarrow\\) ATAC-Seq read counts.\nPampari et al, ChromBPNet, 2023\n\nNotes:\n\nIs there any other mechanism by which a variant can influence outcome except TF regulation?"
  },
  {
    "objectID": "listen/group-meeting/2023-06-21-chirag-lakhani.html#presentation-by-chirag-lakhani",
    "href": "listen/group-meeting/2023-06-21-chirag-lakhani.html#presentation-by-chirag-lakhani",
    "title": "2023-06-21",
    "section": "",
    "text": "Apply DL to predict and interpret the functional effects of AD-associated variants on DNA regulation and RNA processing. How are they linked to pathways and networks?\n\nAD is a polygenic disease.\nLatest GWAS: Bellenguez et al, Nature Genetics, 2022\nControversy - drugs focus on particular pathways, but some kind of fails, expensive.\n\nCategories of pathogenic variants:\n\ncoding variants\ntranscriptional variants (need to know causal cell types) - disrupt TF binding (cell-type specific enhancers/promoter) - modify “epigenome” of a cell type (chromatin accessibility, histone modifications, 3D architecture - differential topology - via disrupting CTCF?)\npost-transcriptional variants (splicing, other activity)\n\nFunctional annotations help in finding molecular features that best explain a polygenic trait. Cano-Gomez et al, Frontier in Genetics, 2020.\nIdea: Use DL delta scores to predict the functional effect of any variant. Input: nucleotide sequence + (DeepSEA: chromatin, SpliceAI: splicing, etc) \\(\\rightarrow\\) Delta score: functional importance.\nMicroglia regulatory regions contain largest percentage of AD GWAS heritability.\nWays to construct DL delta score annotations:\n\nIntegrate DL-based TF binding disruption scores with cell-type specific regulatory genomic regions. – Enformer model trained on ENCODE cell types (K562, HepG2, etc) – use epigenomic data from neuronal cell types.\nTrain DL models predicting cell-type specific assay read counts as a function of genomic DNA sequence – functional genomic assays like ATAC-Seq, H3K27ac and H3K4me3 – cell types microglia, astrocytes, oligodendrocytes and neuron – access to microglia ATAC-Seq data\n\nEnformer: predicts 1000s of functional genomic assays from long input sequence (~200kb). Input: DNA sequence \\(\\rightarrow\\) convolution + transformation layes on human + mouse tracks \\(\\rightarrow\\) Output: genomic tracks. Avsec et al, Nature Methods, 2021\nOverlap regions of predicted TF disruption with promoter/enhancer regions. Enformer predicted TF disruption help localize AD GWAS signal.\nDL models can help finemapping."
  },
  {
    "objectID": "listen/group-meeting/2023-06-21-chirag-lakhani.html#training-dl-models-of-chromatin-accessibility-for-microglia",
    "href": "listen/group-meeting/2023-06-21-chirag-lakhani.html#training-dl-models-of-chromatin-accessibility-for-microglia",
    "title": "2023-06-21",
    "section": "",
    "text": "Multi-task DL model using chromatin accessibility data from 4 individuals. DNA sequence \\(\\rightarrow\\) ATAC-Seq read counts.\nPampari et al, ChromBPNet, 2023\n\nNotes:\n\nIs there any other mechanism by which a variant can influence outcome except TF regulation?"
  },
  {
    "objectID": "listen/group-meeting/2023-04-12-adas-group-meeting.html",
    "href": "listen/group-meeting/2023-04-12-adas-group-meeting.html",
    "title": "2023-04-12",
    "section": "",
    "text": "She is using functional annotation to improve finding rare variants which are associated with Alzheimer’s disease.\n\n\nTwo types of test:\n\nGene based RV association test.\nDeep learning burden test\n\nTypes of rare variant association tests:\n\nburden tests collase rare variants into gene scores. e.g. ARIEL, CAST, WSS Loses power when variant effects are in opposing directions, or many non-causal variants.\nadaptive burden tests, use weights and thresholds. e.g. ADA, aSum, VT\ndispersion tests, test variance of genetic effect, e.g. SKAT, C-alpha, SSU\ncombined tests, burden + dispersion tests combined, e.g. SKAT-O, Fisher, MIST\nannotation-based tests, add annotations to existing methods, e.g. STAAR, RAVA-FIRST, FST\n\nFuntional score test (FST) workflow:\n\nCoding variants, within start/end of genes defined by ensemble\nNC variants, Activity-by-contact (ABC) model predicts promoter and enhancer regions of genes.\nRare variants only – gnomAD AF &lt; 0.05\nMap to annotations\nMap to ADSP individuals\n\nThings I did not understand:\n\nWhy is the Mahattan plot skewed?\nHow does the p-value distribution looks in null data?\n\nInteresting comments:\n\nJiayu mentioned about the ESM annotation from this paper: Language models enable zero-shot prediction of the effects of mutations on protein function by Meier, Rao, Verkuil, Liu, Sercu and Rives."
  },
  {
    "objectID": "listen/group-meeting/2023-04-12-adas-group-meeting.html#presentation-by-anjali-das",
    "href": "listen/group-meeting/2023-04-12-adas-group-meeting.html#presentation-by-anjali-das",
    "title": "2023-04-12",
    "section": "",
    "text": "She is using functional annotation to improve finding rare variants which are associated with Alzheimer’s disease.\n\n\nTwo types of test:\n\nGene based RV association test.\nDeep learning burden test\n\nTypes of rare variant association tests:\n\nburden tests collase rare variants into gene scores. e.g. ARIEL, CAST, WSS Loses power when variant effects are in opposing directions, or many non-causal variants.\nadaptive burden tests, use weights and thresholds. e.g. ADA, aSum, VT\ndispersion tests, test variance of genetic effect, e.g. SKAT, C-alpha, SSU\ncombined tests, burden + dispersion tests combined, e.g. SKAT-O, Fisher, MIST\nannotation-based tests, add annotations to existing methods, e.g. STAAR, RAVA-FIRST, FST\n\nFuntional score test (FST) workflow:\n\nCoding variants, within start/end of genes defined by ensemble\nNC variants, Activity-by-contact (ABC) model predicts promoter and enhancer regions of genes.\nRare variants only – gnomAD AF &lt; 0.05\nMap to annotations\nMap to ADSP individuals\n\nThings I did not understand:\n\nWhy is the Mahattan plot skewed?\nHow does the p-value distribution looks in null data?\n\nInteresting comments:\n\nJiayu mentioned about the ESM annotation from this paper: Language models enable zero-shot prediction of the effects of mutations on protein function by Meier, Rao, Verkuil, Liu, Sercu and Rives."
  },
  {
    "objectID": "listen/group-meeting/2023-08-09-sophia.html",
    "href": "listen/group-meeting/2023-08-09-sophia.html",
    "title": "2023-08-09",
    "section": "",
    "text": "scRNA-seq can provide a more nuanced understanding of splicing across cell states and types.\n\n\nExon inclusion identifies presence or absence of an exon in a given splicing event. Junction usage split reads used to identify intron/exon boundaries.\n\nExon inclusion may have more reads associated but also requires splicing annotation.\nPSI: percent spliced in. Metric used to measure either exon inclusion or junction usage.\n\n\n\n\nChallenges\n\nLimited coverage for full transcript (3’ bias) within high throughput sequencing (10x) \\(\\rightarrow\\) alternate scRNA-seq approaches, e.g. Smart-seq, SPLiT-seq, long read methods. Smart-seq provides better full transcript coverage (but lower throughput). SPLiT-seq has higher throughput (but lower coverage than Smart-seq).\nSparsity. Small percentage of junctions and clusters with reads in a given single cell (total junctions = 38,802 and clusters = 11,585). Less than 4% clusters and less than 1% junctions are observed.\nDifferential splicing across cells.\n\nMotivations\nUMAP can capture the same clustering information from splicing data (compared to that from gene expression).\n\n\n\n\nTabula Muris (Tabula Sapiens)\nZooBrain (Satija Lab)\nPBMC (ParseBio)\n\n\n\n\n\nBRIE2. Read counts are measured for two distinct isoforms in a given splice event (plus ambiguous counts). PSI is learned for splice events across cell types. Bayesian approach allows for some knowledge of relative uncertainty of differential splicing. Drawbacks: only considers 2 isoform events, only skipped exon events made it through the pipeline, unclear exactly what sort of splicing patterns are being detected.\nPsix. Foreground model, exon inclusion should be similar to other nearby cells. Distance measured within low-dimension projeciton. Background model, exon inclusion reflects global average. Benefits: does not require pre-defined cell states / types, gives a continuous picture of splicing. Drawbacks: only considers skipped exon events, may need to consider gene expression bias, not the easiest to run due to many involved input files required.\nSpliZ. Junctions are considered if 3’ site has multiple associated 5’ sites. Junctions are ranked and averaged by distance between 3’ site per cell. SpliZ scores indicate a cell’s deviance from average junction distance. Benefits: Can model more than just SE events. Only needs to perform one test per gene. Drawbacks: Needs at least 2 junctions to consider a splice event. Finding a most commonly used junction by length excludes a lot of information about the cell’s splicing profile.\n\n\n\n\n\nLarge knowledge gap between scores/information outputted by the models and actual splicing profile.\nMany methods require splicing annotations, limiting discovery of novel splice sites.\nMany methods require pre-defined cell types / states.\nLimited splicing event type capture."
  },
  {
    "objectID": "listen/group-meeting/2023-08-09-sophia.html#presentation-by-sophia",
    "href": "listen/group-meeting/2023-08-09-sophia.html#presentation-by-sophia",
    "title": "2023-08-09",
    "section": "",
    "text": "scRNA-seq can provide a more nuanced understanding of splicing across cell states and types.\n\n\nExon inclusion identifies presence or absence of an exon in a given splicing event. Junction usage split reads used to identify intron/exon boundaries.\n\nExon inclusion may have more reads associated but also requires splicing annotation.\nPSI: percent spliced in. Metric used to measure either exon inclusion or junction usage.\n\n\n\n\nChallenges\n\nLimited coverage for full transcript (3’ bias) within high throughput sequencing (10x) \\(\\rightarrow\\) alternate scRNA-seq approaches, e.g. Smart-seq, SPLiT-seq, long read methods. Smart-seq provides better full transcript coverage (but lower throughput). SPLiT-seq has higher throughput (but lower coverage than Smart-seq).\nSparsity. Small percentage of junctions and clusters with reads in a given single cell (total junctions = 38,802 and clusters = 11,585). Less than 4% clusters and less than 1% junctions are observed.\nDifferential splicing across cells.\n\nMotivations\nUMAP can capture the same clustering information from splicing data (compared to that from gene expression).\n\n\n\n\nTabula Muris (Tabula Sapiens)\nZooBrain (Satija Lab)\nPBMC (ParseBio)\n\n\n\n\n\nBRIE2. Read counts are measured for two distinct isoforms in a given splice event (plus ambiguous counts). PSI is learned for splice events across cell types. Bayesian approach allows for some knowledge of relative uncertainty of differential splicing. Drawbacks: only considers 2 isoform events, only skipped exon events made it through the pipeline, unclear exactly what sort of splicing patterns are being detected.\nPsix. Foreground model, exon inclusion should be similar to other nearby cells. Distance measured within low-dimension projeciton. Background model, exon inclusion reflects global average. Benefits: does not require pre-defined cell states / types, gives a continuous picture of splicing. Drawbacks: only considers skipped exon events, may need to consider gene expression bias, not the easiest to run due to many involved input files required.\nSpliZ. Junctions are considered if 3’ site has multiple associated 5’ sites. Junctions are ranked and averaged by distance between 3’ site per cell. SpliZ scores indicate a cell’s deviance from average junction distance. Benefits: Can model more than just SE events. Only needs to perform one test per gene. Drawbacks: Needs at least 2 junctions to consider a splice event. Finding a most commonly used junction by length excludes a lot of information about the cell’s splicing profile.\n\n\n\n\n\nLarge knowledge gap between scores/information outputted by the models and actual splicing profile.\nMany methods require splicing annotations, limiting discovery of novel splice sites.\nMany methods require pre-defined cell types / states.\nLimited splicing event type capture."
  },
  {
    "objectID": "listen/group-meeting/2023-06-07-sei-chang.html",
    "href": "listen/group-meeting/2023-06-07-sei-chang.html",
    "title": "2023-06-07",
    "section": "",
    "text": "Pre-mRNA splicing order is predetermined. Most genes spliced in one or few predominant orders. Preserved across different cell types and stages of neuron differentiation.\n\nDirect RNA nanopore sequencing of chromatin-associated polyA-selected RNA from human K562 cells.\nSequencing of differentiated spinal motor neurons at three time points (D4, D9, D14).\nFocus on post-transcriptional splicing, widespread in human cells.\n\nGiven: counts of partially spliced reads describing splicing status of each intron. Task: Apply deep learning on pre-mRNA sequence to find strongest determinants for predicting likeliest splicing order."
  },
  {
    "objectID": "listen/group-meeting/2023-06-07-sei-chang.html#presentation-by-sei-chang",
    "href": "listen/group-meeting/2023-06-07-sei-chang.html#presentation-by-sei-chang",
    "title": "2023-06-07",
    "section": "",
    "text": "Pre-mRNA splicing order is predetermined. Most genes spliced in one or few predominant orders. Preserved across different cell types and stages of neuron differentiation.\n\nDirect RNA nanopore sequencing of chromatin-associated polyA-selected RNA from human K562 cells.\nSequencing of differentiated spinal motor neurons at three time points (D4, D9, D14).\nFocus on post-transcriptional splicing, widespread in human cells.\n\nGiven: counts of partially spliced reads describing splicing status of each intron. Task: Apply deep learning on pre-mRNA sequence to find strongest determinants for predicting likeliest splicing order."
  },
  {
    "objectID": "listen/group-meeting/2023-06-07-sei-chang.html#model-architecture-convolutional-lstm",
    "href": "listen/group-meeting/2023-06-07-sei-chang.html#model-architecture-convolutional-lstm",
    "title": "2023-06-07",
    "section": "Model Architecture: Convolutional LSTM",
    "text": "Model Architecture: Convolutional LSTM\n\nSequence of time distributed convolutional layer + LSTM.\nStack multiple convLSTM."
  },
  {
    "objectID": "listen/group-meeting/2023-06-07-sei-chang.html#insplico-quantify-intron-splicing-order.",
    "href": "listen/group-meeting/2023-06-07-sei-chang.html#insplico-quantify-intron-splicing-order.",
    "title": "2023-06-07",
    "section": "Insplico: quantify intron splicing order.",
    "text": "Insplico: quantify intron splicing order.\nAISO: Adjacent Intron Splicing Order.\n\nInput: mapped short or long-read RNA-Seq.\nOutput: intron read count and other statistics."
  },
  {
    "objectID": "listen/group-meeting/2023-07-05-megan-schertzer.html",
    "href": "listen/group-meeting/2023-07-05-megan-schertzer.html",
    "title": "2023-07-05",
    "section": "",
    "text": "Alternative splicing regulates ~95% of multi-exon genes. It is regulated by (1) cis-acting pre-messenger RNA sequences, and (2) trans-acting RNA-binding proteins.\nProject 1. Pooled RNA-IP approach to investigate variant effects on RBP binding and splicing.\nProject 2. Isoform-specific functions using Cas13 knockdown and cDNA overexpression.\nAS changes protein output to define cell-type or condition specific functions. Potential effects:\n\nProtein localization\nNucleic acid binding\nCo-factor binding\n\n(RBPs show isoforms themselves.)\nRBFOX2\nwell-established splicing factor with complex isoform structure. Alternative start sites, and 2 alternative junctions.\n\n\nDesign sgRNA for junction level, knockdown and measure qPCR. High throughput, versatile (can target exons, alternative starts/ends and alternative 5’/3’ sites), targets endogeneous transcripts, doesn’t change underlying DNA locus. Disadvantages: some isoforms do not have fully unique seq for gRNA targeting, limited to studying isoforms expressed in cell type, feedback loop (?).\n\n\n\n\nCan express any isoform of interest\nCan express isoforms at similar levels\ncleaner experiments using FLAG tag to isolate isoforms\nDisadvantage: not scalable.\nCan help to study protein localization, RNA binding\n\nHow to summarize potential functional differences of RBP isoforms and prioritize isoforms for follow-up studies?\nHow to scale up the cDNA overexpression system?"
  },
  {
    "objectID": "listen/group-meeting/2023-07-05-megan-schertzer.html#presentation-by-megan-schertzer",
    "href": "listen/group-meeting/2023-07-05-megan-schertzer.html#presentation-by-megan-schertzer",
    "title": "2023-07-05",
    "section": "",
    "text": "Alternative splicing regulates ~95% of multi-exon genes. It is regulated by (1) cis-acting pre-messenger RNA sequences, and (2) trans-acting RNA-binding proteins.\nProject 1. Pooled RNA-IP approach to investigate variant effects on RBP binding and splicing.\nProject 2. Isoform-specific functions using Cas13 knockdown and cDNA overexpression.\nAS changes protein output to define cell-type or condition specific functions. Potential effects:\n\nProtein localization\nNucleic acid binding\nCo-factor binding\n\n(RBPs show isoforms themselves.)\nRBFOX2\nwell-established splicing factor with complex isoform structure. Alternative start sites, and 2 alternative junctions.\n\n\nDesign sgRNA for junction level, knockdown and measure qPCR. High throughput, versatile (can target exons, alternative starts/ends and alternative 5’/3’ sites), targets endogeneous transcripts, doesn’t change underlying DNA locus. Disadvantages: some isoforms do not have fully unique seq for gRNA targeting, limited to studying isoforms expressed in cell type, feedback loop (?).\n\n\n\n\nCan express any isoform of interest\nCan express isoforms at similar levels\ncleaner experiments using FLAG tag to isolate isoforms\nDisadvantage: not scalable.\nCan help to study protein localization, RNA binding\n\nHow to summarize potential functional differences of RBP isoforms and prioritize isoforms for follow-up studies?\nHow to scale up the cDNA overexpression system?"
  },
  {
    "objectID": "listen/journal-club/2023-04-13-coop-book-chapter-6.html",
    "href": "listen/journal-club/2023-04-13-coop-book-chapter-6.html",
    "title": "Chapter 6, Population Genetics by Graham Coop",
    "section": "",
    "text": "The chapter discusses how genetic differentiation build up between closely related population. Using \\(F_{ST}\\) statistic, Coop provided quantitative formulation to understand the genetic divergence between two sub-population, for example, after migration.\n\n\n\nTo understand the effect of genetic drift of population structure, imagine a population of constant size of \\(N_e\\) diploid individuals that \\(T\\) generations in the past split into two sub-populations each of size \\(N_e\\) individuals, which do not subsequently exchange migrants. In the current day we sample an equal number of alleles from both subpopulations.\nConsider a pair of alleles sampled within one of our sub-populations and think about their per site heterozygosity. These alleles have experienced a population of size \\(N_e\\) and so the probability that they differ is \\(H_S \\approx 4N_e \\mu\\) (assuming that \\(N_e \\mu \\ll 1\\), using the equation for heterozygosity within a population).\nAssume equal sampling from both sub-populations, total heterozygosity is given by,\n\\[\nH_T = 0.5 H_S + 0.5 H_B\n\\] where \\(H_B\\) is the probability that a pair of alleles drawn from the two different sub-populations differ from each other. A pair of alleles from different sub-populations cannot find a common ancestor with each other for at least \\(T\\) generations into the past as they are in distinct populations (not connected by migration). Once these alleles find themselves back in the combined ancestral population it takes them on average \\(2N\\) generations to coalesce. So the total opportunity for mutation between the pair of alleles sampled from different populations is \\(2 (T + 2N )\\) generations of meioses, such that the probability that the pairs of alleles is different is \\[\nH_B \\approx 2\\mu ( T + 2 N) %\\left( 1-(1-\\mu)^{2T} \\right) + (1-\\mu)^{2T}\n  %\\frac{\\theta}{\\theta+1}\n\\]\n\\[\nF_{ST} \\approx \\frac{ \\mu T}{\\mu T +  4N_e\\mu }  = \\frac{ T}{ T +  4N_e}\n\\]\n\n\n\nSome other concepts that we discussed include a simple model of migration, incomplete lineage sorting, and testing for gene flow. Summary (from the book):\n\nOnly a small number of migrants between populations per generation is sufficient to prevent the build up of neutral allele frequency differentiation.\nIncomplete lineage sorting of ancestral variation is one source of disagreement between population/species-trees and gene trees. It occurs when the split times between populations are in quick enough succession that lineages do not have time coalese between more closely related populations.\nGene flow can also lead to patterns similar to incomplete lineage sorting. We can test between a model of incomplete lineage sorting and gene flow using tests such as ABBA-BABA."
  },
  {
    "objectID": "listen/journal-club/2023-04-13-coop-book-chapter-6.html#neutral-diversity-and-population-structure",
    "href": "listen/journal-club/2023-04-13-coop-book-chapter-6.html#neutral-diversity-and-population-structure",
    "title": "Chapter 6, Population Genetics by Graham Coop",
    "section": "",
    "text": "The chapter discusses how genetic differentiation build up between closely related population. Using \\(F_{ST}\\) statistic, Coop provided quantitative formulation to understand the genetic divergence between two sub-population, for example, after migration.\n\n\n\nTo understand the effect of genetic drift of population structure, imagine a population of constant size of \\(N_e\\) diploid individuals that \\(T\\) generations in the past split into two sub-populations each of size \\(N_e\\) individuals, which do not subsequently exchange migrants. In the current day we sample an equal number of alleles from both subpopulations.\nConsider a pair of alleles sampled within one of our sub-populations and think about their per site heterozygosity. These alleles have experienced a population of size \\(N_e\\) and so the probability that they differ is \\(H_S \\approx 4N_e \\mu\\) (assuming that \\(N_e \\mu \\ll 1\\), using the equation for heterozygosity within a population).\nAssume equal sampling from both sub-populations, total heterozygosity is given by,\n\\[\nH_T = 0.5 H_S + 0.5 H_B\n\\] where \\(H_B\\) is the probability that a pair of alleles drawn from the two different sub-populations differ from each other. A pair of alleles from different sub-populations cannot find a common ancestor with each other for at least \\(T\\) generations into the past as they are in distinct populations (not connected by migration). Once these alleles find themselves back in the combined ancestral population it takes them on average \\(2N\\) generations to coalesce. So the total opportunity for mutation between the pair of alleles sampled from different populations is \\(2 (T + 2N )\\) generations of meioses, such that the probability that the pairs of alleles is different is \\[\nH_B \\approx 2\\mu ( T + 2 N) %\\left( 1-(1-\\mu)^{2T} \\right) + (1-\\mu)^{2T}\n  %\\frac{\\theta}{\\theta+1}\n\\]\n\\[\nF_{ST} \\approx \\frac{ \\mu T}{\\mu T +  4N_e\\mu }  = \\frac{ T}{ T +  4N_e}\n\\]\n\n\n\nSome other concepts that we discussed include a simple model of migration, incomplete lineage sorting, and testing for gene flow. Summary (from the book):\n\nOnly a small number of migrants between populations per generation is sufficient to prevent the build up of neutral allele frequency differentiation.\nIncomplete lineage sorting of ancestral variation is one source of disagreement between population/species-trees and gene trees. It occurs when the split times between populations are in quick enough succession that lineages do not have time coalese between more closely related populations.\nGene flow can also lead to patterns similar to incomplete lineage sorting. We can test between a model of incomplete lineage sorting and gene flow using tests such as ABBA-BABA."
  },
  {
    "objectID": "listen/journal-club/2023-07-13-geneformer.html",
    "href": "listen/journal-club/2023-07-13-geneformer.html",
    "title": "Geneformer",
    "section": "",
    "text": "Transfer learning from gene network\n\nPresented by Tatsuhiko\nTransfer learning \\(\\rightarrow\\) knowledge learnt for one task is used for a different but related task."
  },
  {
    "objectID": "listen/journal-club/2023-08-10-deep-learning-models-transcriptome-variation.html",
    "href": "listen/journal-club/2023-08-10-deep-learning-models-transcriptome-variation.html",
    "title": "Deep Learning Transcriptome",
    "section": "",
    "text": "Personal transcriptome variation is poorly explained by current genomic deep learning models\nHuang et. al, bioRxiv, 10.1101/2023.06.30.547100\n\nPresented by Chirag"
  },
  {
    "objectID": "listen/journal-club/2023-04-27-coop-book-chapter-7.html",
    "href": "listen/journal-club/2023-04-27-coop-book-chapter-7.html",
    "title": "Chapter 7, Population Genetics by Graham Coop",
    "section": "",
    "text": "The chapter starts with discussion of additive genetic variance and how it contributes to heritability. Rare variants with high effects on phenotype contribute to smaller proportion of heritability compared to common variants (higher MAF) with smaller effects on phenotype.\nNarrow sense heritability: Proportion of the variance that is explained by the additive genetic effect.\nThe main concept is that we can estimate the additive genetic variance and the heritability by using the resemblance of relatives, if we can experimentally remove or statistically partition out the effect of the shared environment among relatives.\nNote: This paper discusses how the estimated genetic variance of the quantitative traits does not measure the “underlying genetic architecture” but the assumed genetic architecture and its corresponding parametrization. When the assumption and parameterization change, the partitioning of variance components also changes."
  },
  {
    "objectID": "listen/journal-club/2023-04-27-coop-book-chapter-7.html#phenotypic-variation-and-the-resemblance-between-relatives.",
    "href": "listen/journal-club/2023-04-27-coop-book-chapter-7.html#phenotypic-variation-and-the-resemblance-between-relatives.",
    "title": "Chapter 7, Population Genetics by Graham Coop",
    "section": "",
    "text": "The chapter starts with discussion of additive genetic variance and how it contributes to heritability. Rare variants with high effects on phenotype contribute to smaller proportion of heritability compared to common variants (higher MAF) with smaller effects on phenotype.\nNarrow sense heritability: Proportion of the variance that is explained by the additive genetic effect.\nThe main concept is that we can estimate the additive genetic variance and the heritability by using the resemblance of relatives, if we can experimentally remove or statistically partition out the effect of the shared environment among relatives.\nNote: This paper discusses how the estimated genetic variance of the quantitative traits does not measure the “underlying genetic architecture” but the assumed genetic architecture and its corresponding parametrization. When the assumption and parameterization change, the partitioning of variance components also changes."
  },
  {
    "objectID": "think/risks-rates-odds.html",
    "href": "think/risks-rates-odds.html",
    "title": "The Little Things",
    "section": "",
    "text": "“The little things are infinitely the most important.” – Sherlock Holmes.\nClinical, epidemiological and genetic studies often seek to understand the “risk factors” for diseases. In this pursuit, we often encounter terms which have important distinctions, but are sometimes used interchangeably by scientists and clinicians, for example, risks, rates and odds. It is important to understand these distinctions and use the terms in their distinctive context. Here, I seek to define some of these terms.\n\nRisk\nRisk is defined as the number of new cases that occur during a specified time period in a population. It involves only new cases, and individuals must be free from the condition at the start of the time period. It is either expressed as a proportion (divided by the total population) ranging from 0 to 1, or as a percent ranging from 0 to 100. This is also referred to as absolute risk or incidence.\n\n\nPrevalence\nPrevalence is defined as the number of cases existing in a population. A prevalence rate is the total number of cases of a disease existing in a population divided by the total population.\n\n\nExposure (or risk factor)\nAn exposure is an event (treatment, presence or absence of some factors, environmental or genetic makeup, etc), also called a risk factor, that changes the risk of disease.\n\n\nRisk ratio (or relative risk)\nRisk ratio, also called relative risk, often abbreviated as RR, is defined as the ratio of the disease risk \\(r_e\\) among individuals exposed to a certain exposure (or risk factor) to the disease risk \\(r_0\\) among nonexposed individuals.\n\\[\n\\textrm{RR} = \\frac{r_e}{r_0}\n\\]\n\n\nSusceptibility\nSusceptibility (\\(s\\)) is coupled with exposure. In the general context, exposures that lead to excess disease risk are considered to increase disease susceptibility. Susceptibility depends on the underlying model of disease causation and has been defined (or measured) in many different ways depending on the context. Due to lack of an exact definition, I will follow Khoury et. al. (Khoury et al. 1989), who used the simple sufficient cause model to derive the general relation of \\(s\\) to risk. Under this model, we assume some exposure E is part of a sufficient cause for the disease and we denote by \\(s\\) the proportion of individuals who have all other components except E. Thus, \\(s\\) is the proportion of “susceptible” persons who, if exposed, would contract the disease.\nTo derive the general relation of \\(s\\) to risk, we consider two events: 1) the event A that the individual is susceptible (via exposure to E), and 2) the event B that a person has a sufficient cause that does not involve exposure E. The probability of events A and B are related as follows:\n\\[\nP(A \\cup B) = P(A) + P(B) - P(A \\cap B)\n\\]\nWe note that, by definition \\(s = P(A)\\), the risk of exposed is \\(r_e = P(A \\cup B)\\), and the risk of unexposed is \\(r_0 = P(A \\cap B)\\). Combining these, we have,\n\\[\ns = r_e - r_0 + P(A \\cap B)\n\\]\nSince \\(P(A \\cap B) \\ge 0\\) and \\(P(A \\cap B) \\le r_0\\), we have\n\\[\nr_e - r_0 \\le s \\le r_e\n\\]\nIf A and B were independent, then \\(P(A \\cap B) = P(A)P(B)\\) and we would have, \\[\ns_{\\textrm{ind}} = \\frac{r_e - r_0}{1 - r_0}\n\\]\nIt is important to note that the definition (and measure) of susceptibility will change under other disease causation models. The concept of susceptibility helps communicate the risk of developing a disease but does not provide a rigorous definition.\n\n\n\n\n\n\n\n\nPhenotypic variance\n\nKhoury, Muin J., W. Dana Flanders, Sander Greenland, and Myron J. Adams. 1989. “On the Measurement of Susceptibility in Epidemiological Studies.” American Journal of Epidemiology 129 (1): 183–90. https://doi.org/10.1093/oxfordjournals.aje.a115107."
  },
  {
    "objectID": "journal/2023-05.html",
    "href": "journal/2023-05.html",
    "title": "2023, May",
    "section": "",
    "text": "Group meeting, listen to talks from “The Biology of Genomes”, a conference at CSHL from May9 - May13, 2023. We listened to two talks:\n\n\n“Discovering stimulatory state specific T2D GWAS mechanisms with single cell multi-omics on iPSC-derived FAP villages” by Christa Ventresca from the Stephen Parker lab,\n“DragoNNFruit—Learning cis- and trans-regulation of chromatin accessibility at single base and single cell resolution” by Jacob Schreiber from the Kundaje lab.\n\n\nStart a Latex document to write the Frank-Wolfe algorithm for nuclear norm matrix factorization."
  },
  {
    "objectID": "journal/2023-05.html#section",
    "href": "journal/2023-05.html#section",
    "title": "2023, May",
    "section": "",
    "text": "Group meeting, listen to talks from “The Biology of Genomes”, a conference at CSHL from May9 - May13, 2023. We listened to two talks:\n\n\n“Discovering stimulatory state specific T2D GWAS mechanisms with single cell multi-omics on iPSC-derived FAP villages” by Christa Ventresca from the Stephen Parker lab,\n“DragoNNFruit—Learning cis- and trans-regulation of chromatin accessibility at single base and single cell resolution” by Jacob Schreiber from the Kundaje lab.\n\n\nStart a Latex document to write the Frank-Wolfe algorithm for nuclear norm matrix factorization."
  },
  {
    "objectID": "journal/2023-05.html#section-1",
    "href": "journal/2023-05.html#section-1",
    "title": "2023, May",
    "section": "2023-05-23",
    "text": "2023-05-23\n\nPython implementation for convex optimization using Frank-Wolfe algorithm.\nI observed that the linear optimization problem using \\(K = 40\\) principal components in the first step of the FW algorithm retains the structure of the matrix, but this is wrong!"
  },
  {
    "objectID": "journal/2023-05.html#section-2",
    "href": "journal/2023-05.html#section-2",
    "title": "2023, May",
    "section": "2023-05-22",
    "text": "2023-05-22\n\nImplement robust PCA using ADMM (Candes’ algorithm) described here. I followed (copied) the implementation by N. Dorukhan Sergin."
  },
  {
    "objectID": "journal/2023-05.html#section-3",
    "href": "journal/2023-05.html#section-3",
    "title": "2023, May",
    "section": "2023-04-16",
    "text": "2023-04-16\n\nClean notebook files, set up workflow for publishing NPD notebooks.\nRead more about conventional PCA and weighted PCA."
  },
  {
    "objectID": "journal/2023-05.html#section-4",
    "href": "journal/2023-05.html#section-4",
    "title": "2023, May",
    "section": "2023-04-15",
    "text": "2023-04-15\n\nImplement Delchambre’s weighted PCA.\nI observed hidden structures for the summary statistics in conventional PCA, but I did not observe structures in weighted PCA. Why?"
  },
  {
    "objectID": "journal/2023-05.html#section-5",
    "href": "journal/2023-05.html#section-5",
    "title": "2023, May",
    "section": "2023-04-12",
    "text": "2023-04-12\n\nImplement preprocessing of \\(\\beta\\) and SE matrix in Python. Required for playing with PCA and understanding the structure of the data."
  },
  {
    "objectID": "journal/2023-05.html#section-6",
    "href": "journal/2023-05.html#section-6",
    "title": "2023, May",
    "section": "2023-04-11",
    "text": "2023-04-11\n\nMeeting with David. We discussed data cleaning and its effect on weighted PCA. See Slack for details.\nProbgen reading club, presented by Scott Adamson. Chapter 8 from Population Genetics book by Graham Coop."
  },
  {
    "objectID": "journal/2023-05.html#section-7",
    "href": "journal/2023-05.html#section-7",
    "title": "2023, May",
    "section": "2023-04-10",
    "text": "2023-04-10\n\nKnowles Lab Meeting, presented by Brielin Brown.\nMeeting with Matthew on GradVI manuscript. Reformat introduction."
  },
  {
    "objectID": "journal/2023-05.html#section-8",
    "href": "journal/2023-05.html#section-8",
    "title": "2023, May",
    "section": "2023-04-09",
    "text": "2023-04-09\n\nGradVI manuscript - reorganize methods and introduction."
  },
  {
    "objectID": "journal/2023-05.html#section-9",
    "href": "journal/2023-05.html#section-9",
    "title": "2023, May",
    "section": "2023-04-08",
    "text": "2023-04-08\n\nNPD Summary Statistics. Look at weighted PCA after data cleaning. It appears that there is not much distinguishable from the principal components."
  },
  {
    "objectID": "journal/2023-05.html#section-10",
    "href": "journal/2023-05.html#section-10",
    "title": "2023, May",
    "section": "2023-04-05",
    "text": "2023-04-05\n\nLast date for NYGC onboarding. Finish courses and benefits election.\nSet up Macbook Pro for work."
  },
  {
    "objectID": "journal/2023-05.html#section-11",
    "href": "journal/2023-05.html#section-11",
    "title": "2023, May",
    "section": "2023-04-04",
    "text": "2023-04-04\n\nMake changes and create pull request on DSC for supporting collections.abc and rpy2 v3.5.11.\nNumerical experiments for dense linear regression for correlated variables.\nPlot results (ELBO, RMSE, runtime) for dense linear regression for correlated variables.\nRun more replicates for the above simulation.\nSeminar by Julia Domingo"
  },
  {
    "objectID": "journal/2023-05.html#section-12",
    "href": "journal/2023-05.html#section-12",
    "title": "2023, May",
    "section": "2023-04-03",
    "text": "2023-04-03\n\nGradVI plots without colors in scatterplot.\nGradVI runtime-per-iteration plot with \\(\\log_{10}\\) scale.\nMeeting with Matthew."
  },
  {
    "objectID": "journal/2023-05.html#section-13",
    "href": "journal/2023-05.html#section-13",
    "title": "2023, May",
    "section": "2023-04-02",
    "text": "2023-04-02\n\nRun genlasso with large \\(n\\) for one simulation at the NYGC cluster.\nOnboarding - Health insurance.\nGenlasso running into out-of-memory error.\nMake changes in GradVI to run without creating the \\(\\mathbb{H}\\) matrix."
  },
  {
    "objectID": "journal/2023-05.html#section-14",
    "href": "journal/2023-05.html#section-14",
    "title": "2023, May",
    "section": "2023-04-01",
    "text": "2023-04-01\n\nThe GradVI trendfiltering runtime experiments have failed. Troubleshoot: 40G memory is not enough for the jobs. I removed jobs with \\(n = (10^5, 10^6)\\) and submitted new jobs with 100G of memory in interactive node. The idea is to run the large jobs separately for GradVI.\nSimulate first order trend filtering data with less memory.\nHow to run GradVI without generating \\(\\mathbf{H}\\) matrix? I derived equations for obtaining \\(d_j\\) without generating the \\(\\mathbf{H}\\) matrix and made the required changes in the GradVI software to run without generating the matrix. This introduced a bug which prevents running trend filtering for higher orders."
  },
  {
    "objectID": "journal/2023-04.html",
    "href": "journal/2023-04.html",
    "title": "2023, April",
    "section": "",
    "text": "Tried and failed to install editable version (pip install -e .) of Python packages with Fortran dependencies.\nAfter installing all packages using conda, I ran pip install --upgrade --force-reinstall which erased everything from the conda environment and reinstalled random packages with pip. I have to reinstall the environment. For the future, I have to find how to get an interactive mode for pip install."
  },
  {
    "objectID": "journal/2023-04.html#section",
    "href": "journal/2023-04.html#section",
    "title": "2023, April",
    "section": "",
    "text": "Tried and failed to install editable version (pip install -e .) of Python packages with Fortran dependencies.\nAfter installing all packages using conda, I ran pip install --upgrade --force-reinstall which erased everything from the conda environment and reinstalled random packages with pip. I have to reinstall the environment. For the future, I have to find how to get an interactive mode for pip install."
  },
  {
    "objectID": "journal/2023-04.html#section-1",
    "href": "journal/2023-04.html#section-1",
    "title": "2023, April",
    "section": "2023-04-27",
    "text": "2023-04-27\n\nProbgen Reading Club, presented by Ashvin Ravi and Ariana Chriss\nSetup GradVI workbench for NYGC cluster. See workflow."
  },
  {
    "objectID": "journal/2023-04.html#section-2",
    "href": "journal/2023-04.html#section-2",
    "title": "2023, April",
    "section": "2023-04-26",
    "text": "2023-04-26\n\nGroup meeting, presentation by Scott Adamson\nSetup Python workbench for NYGC cluster. See workflow."
  },
  {
    "objectID": "journal/2023-04.html#section-3",
    "href": "journal/2023-04.html#section-3",
    "title": "2023, April",
    "section": "2023-04-25",
    "text": "2023-04-25\n\nGradVI. Scatterplot comparing number of iterations, total runtime and ELBO between (a) GradVI compound and CAVI, and (b) GradVI direct and CAVI) for strongly correlated (\\(r^2 = 0.99\\)) covariates in case of multiple linear regression. Create new DSC simulation to calculate runtime of trendfiltering in higher dimension.\nMeeting with Matthew. Discuss Stochastic Gradient Descent (SGD) and natural gradients. Discuss list of things to be done before the manuscript can be reviewed by Matthew."
  },
  {
    "objectID": "journal/2023-04.html#section-4",
    "href": "journal/2023-04.html#section-4",
    "title": "2023, April",
    "section": "2023-04-24",
    "text": "2023-04-24\n\nFix RStudio server.\nSubmit jobs for trend filtering (RCC at UChicago)."
  },
  {
    "objectID": "journal/2023-04.html#section-5",
    "href": "journal/2023-04.html#section-5",
    "title": "2023, April",
    "section": "2023-04-21",
    "text": "2023-04-21\n\nMeeting with Ekene and Gilead. They are working on improving SparsePro using gradient descent optimization for estimating the coefficients \\(w\\) for functional annotations.\nNPD. Fix errors in extraction of summary statistics of selected variants from PGC. Clean the R code for reading all the data.\nRStudio server is not showing plots"
  },
  {
    "objectID": "journal/2023-04.html#section-6",
    "href": "journal/2023-04.html#section-6",
    "title": "2023, April",
    "section": "2023-04-20",
    "text": "2023-04-20\n\nJournal Club. Anjali discussed the article, “Adjusting for common variant polygenic scores improves yield in rare variant association analyses”, Jurgens et al, Nature Genetics 55, 544–548 (2023). Link. Using 65 traits from the UK Biobank data, the authors showed that including PGS as a fixed-effect covariate in linear mixed model analysis (using GENESIS) improved the yield and discovery power for rare variant association signal. The authors constructed PGS for each trait based on two different methods: (1) lead-SNP, and (2) PRS-CS, which applies a Bayesian regression framework to identify posterior variant effect sizes based on a continuous shrinkage prior, which is directly learnt from the data\nNPD. Tidy the selection of variants from GTEx and PGC summary statistics, extract the summary statistics of selected variants from PGC, OpenGWAS and GTEx."
  },
  {
    "objectID": "journal/2023-04.html#section-7",
    "href": "journal/2023-04.html#section-7",
    "title": "2023, April",
    "section": "2023-04-19",
    "text": "2023-04-19\n\nGroup meeting, presentation by Tatsuhiko Naito\nADSP meeting. Anjali discussed the p-value distributions from FST.\nSetup RStudio at NYGC cluster.\nNPD. David shared the pilot project for NPD. I looked at the data cleaning of the summary statistics.\nSetup the NPD website."
  },
  {
    "objectID": "journal/2023-04.html#section-8",
    "href": "journal/2023-04.html#section-8",
    "title": "2023, April",
    "section": "2023-04-18",
    "text": "2023-04-18\n\nGradVI. Discuss figure with Peter.\nSetup cluster access at NYGC."
  },
  {
    "objectID": "journal/2023-04.html#section-9",
    "href": "journal/2023-04.html#section-9",
    "title": "2023, April",
    "section": "2023-04-17",
    "text": "2023-04-17\n\nGradVI. Simulation complete for linear regression with correlated variables, \\(r^2 = 0.99\\). Run dscquery for collecting results. Compare niter between GradVI (compound) and GradVI (direct) and mr.ash. Share figure on slack.\nGeneral Safety and Compliance Orientation"
  },
  {
    "objectID": "journal/2023-04.html#section-10",
    "href": "journal/2023-04.html#section-10",
    "title": "2023, April",
    "section": "2023-04-14",
    "text": "2023-04-14\n\nRaj/Knowles joint group meeting at ISMMS.\nKick-off meeting with Niamh."
  },
  {
    "objectID": "journal/2023-04.html#section-11",
    "href": "journal/2023-04.html#section-11",
    "title": "2023, April",
    "section": "2023-04-13",
    "text": "2023-04-13\n\nSetup navigation in Quarto journal.\nProbgen Reading Club, presentation by Sei Chang\nGradVI. Create new notebook for linear regression with correlated variables, find examples where GradVI converge faster than CAVI, set up DSC simulation pipeline for those examples, submit DSC job on interactive node at RCC, check jobs are running properly (no error in data generation, lasso initialization)."
  },
  {
    "objectID": "journal/2023-04.html#section-12",
    "href": "journal/2023-04.html#section-12",
    "title": "2023, April",
    "section": "2023-04-12",
    "text": "2023-04-12\nThis is the beginning of my NYGC journal, on my third day here.\n\nAttend general group meeting, presentation by Anjali.\nAttend ADSP group meeting.\nSetup Quarto journal.\nWork on GradVI manuscript."
  },
  {
    "objectID": "journal/index.html",
    "href": "journal/index.html",
    "title": "Daily Journal",
    "section": "",
    "text": "In this section, I keep a daily log of my activities and accomplishments. This serves as both a personal record of my progress and a way to keep myself accountable and motivated."
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "My research journal at the NYGC",
    "section": "",
    "text": "Welcome to my journal, where I keep track of my daily work and thoughts at the New York Genome Center. My primary goals in maintaining this journal are twofold: (1) to make my research reproducible and (2) to increase my productivity by avoiding repetition and sharing my work with colleagues.\nIn these pages, you will find an eclectic (sometimes erratic) mix of my research activities, including ideas, equations, code snippets, figures, and more. Thank you for joining me on this journey of discovery and exploration in genomics research. \nTo learn more about my work and research interests, please visit my main portfolio website."
  },
  {
    "objectID": "journal/2023-07.html",
    "href": "journal/2023-07.html",
    "title": "2023, July",
    "section": "",
    "text": "Read “Efficient Optimization Algorithms for Robust Principal Component Analysis and Its Variants” by Ma and Serhat Aybat, 2018."
  },
  {
    "objectID": "journal/2023-07.html#section",
    "href": "journal/2023-07.html#section",
    "title": "2023, July",
    "section": "",
    "text": "Read “Efficient Optimization Algorithms for Robust Principal Component Analysis and Its Variants” by Ma and Serhat Aybat, 2018."
  },
  {
    "objectID": "journal/2023-07.html#section-1",
    "href": "journal/2023-07.html#section-1",
    "title": "2023, July",
    "section": "2023-07-26",
    "text": "2023-07-26\n\nWhat is the difference between Algorithm 1 (PCP by Alternating Directions) of Candes et. al., 2009 and Algorithm 5 (inexact ALM) of Lin et. al., 2013?"
  },
  {
    "objectID": "journal/2023-07.html#section-2",
    "href": "journal/2023-07.html#section-2",
    "title": "2023, July",
    "section": "2023-07-25",
    "text": "2023-07-25\n\nRefactor RPCA class in NNM software.\nListen to Peter Visscher."
  },
  {
    "objectID": "journal/2023-07.html#section-3",
    "href": "journal/2023-07.html#section-3",
    "title": "2023, July",
    "section": "2023-07-24",
    "text": "2023-07-24\n\nSetup CV class for NNMFW using Frank-Wolfe algorithm.\nApply CV class to simulations to check implementation."
  },
  {
    "objectID": "journal/2023-07.html#section-4",
    "href": "journal/2023-07.html#section-4",
    "title": "2023, July",
    "section": "2023-07-21",
    "text": "2023-07-21\n\nRead about image denoising using different nuclear norm regularization methods."
  },
  {
    "objectID": "journal/2023-07.html#section-5",
    "href": "journal/2023-07.html#section-5",
    "title": "2023, July",
    "section": "2023-07-20",
    "text": "2023-07-20\n\nDebug class for NNM with Frank-Wolfe algorithm."
  },
  {
    "objectID": "journal/2023-07.html#section-6",
    "href": "journal/2023-07.html#section-6",
    "title": "2023, July",
    "section": "2023-07-06",
    "text": "2023-07-06\n\nModify main plot of GradVI manuscript, include ELBO convergence, remove PVE 0.4 and 0.6, remove trendfiltering order 1.\nMeeting with Matthew. Notes: check scaling of trendfiltering matrix, implement Newton’s method."
  },
  {
    "objectID": "journal/2023-07.html#section-7",
    "href": "journal/2023-07.html#section-7",
    "title": "2023, July",
    "section": "2023-07-05",
    "text": "2023-07-05\n\nSimple examples of truncated SVD, nuclear norm minimization and RobustPCA on simulated data.\nGroup meeting by Megan. Meeting notes.\nMeeting with David. Notes: simulations with \\(m = 0\\), implement weights in RobustPCA, regression coefficients vs z-scores."
  },
  {
    "objectID": "journal/2023-06.html",
    "href": "journal/2023-06.html",
    "title": "2023, June",
    "section": "",
    "text": "Knowles-Raj meeting, presented by Aline. I did not take meeting notes.\nContinue simulation setup. Study about correlated variables, and validation of clustering: internal and external.\nHow to benchmark different methods using real data? In real data, we know the true labels (broad phenotypes). Each method provides a reduced rank approximation, \\(Y_{\\mathrm{opt}}\\). One idea is to classify based on \\(Y_{\\mathrm{opt}}\\) and compare the clusters with the true labels. We assume that the best methods will give the best clusters."
  },
  {
    "objectID": "journal/2023-06.html#section",
    "href": "journal/2023-06.html#section",
    "title": "2023, June",
    "section": "",
    "text": "Knowles-Raj meeting, presented by Aline. I did not take meeting notes.\nContinue simulation setup. Study about correlated variables, and validation of clustering: internal and external.\nHow to benchmark different methods using real data? In real data, we know the true labels (broad phenotypes). Each method provides a reduced rank approximation, \\(Y_{\\mathrm{opt}}\\). One idea is to classify based on \\(Y_{\\mathrm{opt}}\\) and compare the clusters with the true labels. We assume that the best methods will give the best clusters."
  },
  {
    "objectID": "journal/2023-06.html#section-1",
    "href": "journal/2023-06.html#section-1",
    "title": "2023, June",
    "section": "2023-06-29",
    "text": "2023-06-29\n\nJournal club presentation, Chapter 10 of Graham Coop’s book. Presented by Anjali and Karin.\nSimulation of correlated feature variables."
  },
  {
    "objectID": "journal/2023-06.html#section-2",
    "href": "journal/2023-06.html#section-2",
    "title": "2023, June",
    "section": "2023-06-28",
    "text": "2023-06-28\n\nSimulation setup for z-scores. Generative model using correlated loadings and orthogonal factors.\nGroup meeting by Claire. Meeting notes.\nNYGC photoshoot."
  },
  {
    "objectID": "journal/2023-06.html#section-3",
    "href": "journal/2023-06.html#section-3",
    "title": "2023, June",
    "section": "2023-06-27",
    "text": "2023-06-27\n\nLiterature review of nuclear norm minimization.\nThink how to evaluate the different methods. Write the tasks to evaluate in latex.\nNotes:\n\nWhy is duality gap negative?\nWhy is duality gap not decreasing monotonically?\nWhat are the possible convergence criteria for the Frank-Wolfe algorithm?"
  },
  {
    "objectID": "journal/2023-06.html#section-4",
    "href": "journal/2023-06.html#section-4",
    "title": "2023, June",
    "section": "2023-06-23",
    "text": "2023-06-23\n\nGradVI. Rerun simulation for comparing GradVI with CAVI in three different settings: independent variables, correlated variables with block-diagonal covariance matrix, trendfiltering."
  },
  {
    "objectID": "journal/2023-06.html#section-5",
    "href": "journal/2023-06.html#section-5",
    "title": "2023, June",
    "section": "2023-06-22",
    "text": "2023-06-22\n\nRead Jaggi 2013 paper on Frank-Wolfe algorithm.\nWrite algorithm and theory for weighted nuclear norm matrix dimensionality reduction.\nJournal club presentation, Chapter 10 of Graham Coop’s book. Presented by Anjali and Karin."
  },
  {
    "objectID": "journal/2023-06.html#section-6",
    "href": "journal/2023-06.html#section-6",
    "title": "2023, June",
    "section": "2023-06-21",
    "text": "2023-06-21\n\nGroup meeting by Chirag Lakhani. Meeting notes.\nMeeting with David. We discussed about 3 main topics:\n\nNPD Sumstats. We discussed about the Frank-Wolfe algorithm. David told that the rank of the optimized matrix was not always at the boundary of the \\(\\ell_1\\) ball. He fixed some errors in the R implementation of weighted PCA – step size was incorrect. Variant 1 of step size ($ = 2 / (2 + t)$) is slower than Variant 2 optimum \\(\\gamma\\) obtained by minimizing the function \\(f(\\mathbf{X} - \\gamma \\mathbf{D})\\), where \\(\\mathbf{D} = \\mathbf{X} - \\mathbf{S}\\). Removing duplicate GWAS from IEU helps delineating the clusters in lower dimension. Can we setup simulations to benchmark the methods? Can we use weights to improve results? How to harmonize the weights? Will Niamh be able to help us in harmonizing the GWAS summary statistics?\nSecond project. We discussed whether to work on splicing project in collaboration with Ivan Iossifov or applying Tejaas on the BigBrain project. We decided to do some pilot work on both before deciding on any one of them.\nFinemapping using annotations. Gilead is trying to rerun the simulations by increasing PVE."
  },
  {
    "objectID": "journal/2023-06.html#section-7",
    "href": "journal/2023-06.html#section-7",
    "title": "2023, June",
    "section": "2023-06-20",
    "text": "2023-06-20\nRerun the exploratory analyses on NPD summary statistics using the newly preprocessed data. I had to include several phenotypes in the meta file, trait_meta.csv."
  },
  {
    "objectID": "journal/2023-06.html#section-8",
    "href": "journal/2023-06.html#section-8",
    "title": "2023, June",
    "section": "2023-06-16",
    "text": "2023-06-16\nClean the NPD summary statistics data. In particular, remove duplicate PGC GWAS from IEU OpenGWAS project, include the GWAS summary statistics imputed on GTEx variants. Earlier preprocessing ignored many GWAS imputed on GTEx."
  },
  {
    "objectID": "journal/2023-06.html#section-9",
    "href": "journal/2023-06.html#section-9",
    "title": "2023, June",
    "section": "2023-06-15",
    "text": "2023-06-15"
  },
  {
    "objectID": "journal/2023-06.html#section-10",
    "href": "journal/2023-06.html#section-10",
    "title": "2023, June",
    "section": "2023-06-14",
    "text": "2023-06-14\n\nGroup meeting presentation at NYGC.\nLook at data preprocessing. I found that many PGC GWAS were included twice (as they were also included in the IEU OpenGWAS project)."
  },
  {
    "objectID": "journal/2023-06.html#section-11",
    "href": "journal/2023-06.html#section-11",
    "title": "2023, June",
    "section": "2023-06-13",
    "text": "2023-06-13\nMostly preparation for group meeting."
  },
  {
    "objectID": "journal/2023-06.html#section-12",
    "href": "journal/2023-06.html#section-12",
    "title": "2023, June",
    "section": "2023-06-12",
    "text": "2023-06-12\n\nStart preparing presentation for group meeting.\nRead about heterogeneity in neuropsychiatric disorders.\nCreate a custom NYGC theme for Apple Keynote.\nUpdate Linkedin profile."
  },
  {
    "objectID": "journal/2023-06.html#section-13",
    "href": "journal/2023-06.html#section-13",
    "title": "2023, June",
    "section": "2023-06-09",
    "text": "2023-06-09\nWork from Home\nRead, write and submit review for an article in Scientific Reports."
  },
  {
    "objectID": "journal/2023-06.html#section-14",
    "href": "journal/2023-06.html#section-14",
    "title": "2023, June",
    "section": "2023-06-08",
    "text": "2023-06-08\nWork from Home\nI read about using Log Bayes Factor as genetic distance between populations to transform the genotype data matrix. Delrieu and Bowman, 2005 discuss the mathematical principles. Delrieu and Bowman, 2006 discuss how it can be applied and visualized. From the Bayes Factor, they use the scene-anchored argument of Evett and Weir, 1998, “Interpreting DNA Evidence, Statistical Genetics for Forensic Scientists” to arrive at a statistic which resembles the likelihood ratio. For details of derivation, see Evett and Weir, 1991, “Flawed reasoning in court”."
  },
  {
    "objectID": "journal/2023-06.html#section-15",
    "href": "journal/2023-06.html#section-15",
    "title": "2023, June",
    "section": "2023-06-07",
    "text": "2023-06-07\n\nGroup meeting, presented by Sei Chang.\nThink about disease risk, prevalence, exposure, risk ratio and susceptibility."
  },
  {
    "objectID": "journal/2023-06.html#section-16",
    "href": "journal/2023-06.html#section-16",
    "title": "2023, June",
    "section": "2023-06-06",
    "text": "2023-06-06\nWork from Home\n\nRead about trend filtering.\nUpdate personal website."
  },
  {
    "objectID": "journal/2023-06.html#section-17",
    "href": "journal/2023-06.html#section-17",
    "title": "2023, June",
    "section": "2023-06-05",
    "text": "2023-06-05\n\nCompare RobustPCA and nuclear norm matrix factorization using Frank-Wolfe algorithm. See Notebook"
  },
  {
    "objectID": "journal/2023-06.html#section-18",
    "href": "journal/2023-06.html#section-18",
    "title": "2023, June",
    "section": "2023-06-02",
    "text": "2023-06-02\nWork from Home\n\nMeeting with Gilead Turok. He is working on finemapping using annotations.\nAttend the Raj-Knowles group meeting.\nRead about PCA.\nUpdate workbench. Install micromamba and Quarto in MacOS. See details."
  },
  {
    "objectID": "journal/2023-06.html#section-19",
    "href": "journal/2023-06.html#section-19",
    "title": "2023, June",
    "section": "2023-06-01",
    "text": "2023-06-01\n\nJournal Club. Teresa presented OTTERS.\nGradVI manuscript.\nMeeting with Matthew."
  },
  {
    "objectID": "think/index.html",
    "href": "think/index.html",
    "title": "Think",
    "section": "",
    "text": "In this section, I note down ideas. Most of them are not very useful, but some of them are interesting!"
  },
  {
    "objectID": "listen/index.html",
    "href": "listen/index.html",
    "title": "Listen",
    "section": "",
    "text": "In this section, I write down my notes and excerpts from talks, tutorials, group meetings and seminars that I listen to."
  },
  {
    "objectID": "listen/journal-club/2023-05-11-coop-book-chapter-8.html",
    "href": "listen/journal-club/2023-05-11-coop-book-chapter-8.html",
    "title": "Chapter 8, Population Genetics by Graham Coop",
    "section": "",
    "text": "Evolution by natural selection requires: 1. Variation in a phenotype. 2. That survival and reproduction is non-random with respect to this phenotypic variation. 3. That this variation is heritable.\nBreeder’s equation: \\[\nR = \\mu_{NG} − \\mu_{BS} = h^2(\\mu_S − \\mu_{BS} ) = h^2S\n\\]\n\n\\(\\mu_{BS}\\) : Mean phenotype Before Selection\n\\(\\mu_{S}\\) : Mean phenotype of individuals who survived to reproduce\n\\(\\mu_{NG}\\) : Mean phenotype of Next Generation\n\\(S = \\mu_S − \\mu_{BS}\\) : Change in mean phenotype within a generation\n\\(R\\) : Response to selection\n\n\n\n\nOver continued generations, the response to selection will be linear\nAssuming no change in heritability and selection differential, \\[\n  \\mu_n = n h^2 S\n  \\]"
  },
  {
    "objectID": "listen/journal-club/2023-05-11-coop-book-chapter-8.html#the-response-to-phenotypic-selection",
    "href": "listen/journal-club/2023-05-11-coop-book-chapter-8.html#the-response-to-phenotypic-selection",
    "title": "Chapter 8, Population Genetics by Graham Coop",
    "section": "",
    "text": "Evolution by natural selection requires: 1. Variation in a phenotype. 2. That survival and reproduction is non-random with respect to this phenotypic variation. 3. That this variation is heritable.\nBreeder’s equation: \\[\nR = \\mu_{NG} − \\mu_{BS} = h^2(\\mu_S − \\mu_{BS} ) = h^2S\n\\]\n\n\\(\\mu_{BS}\\) : Mean phenotype Before Selection\n\\(\\mu_{S}\\) : Mean phenotype of individuals who survived to reproduce\n\\(\\mu_{NG}\\) : Mean phenotype of Next Generation\n\\(S = \\mu_S − \\mu_{BS}\\) : Change in mean phenotype within a generation\n\\(R\\) : Response to selection\n\n\n\n\nOver continued generations, the response to selection will be linear\nAssuming no change in heritability and selection differential, \\[\n  \\mu_n = n h^2 S\n  \\]"
  },
  {
    "objectID": "listen/journal-club/2023-05-11-coop-book-chapter-8.html#the-darwin",
    "href": "listen/journal-club/2023-05-11-coop-book-chapter-8.html#the-darwin",
    "title": "Chapter 8, Population Genetics by Graham Coop",
    "section": "The Darwin",
    "text": "The Darwin\nUnit of evolution. Fold relative change in phenotype. The greater the time separating similar initial and final states, the slower the inferred rate of change. Although it is counter-intuitive at first, Gingerich (1983) gives two reasons as to why this could happen:\n\nOrganisms differing by a factor of much more (or less) than 1.2 are so different (or so similar) that they are rarely compared in calculating rates, regardless of the time available. (Meaning, high change rate over long time will be systematically ignored.)\nRates are based on net change between initial and final states. A period of rapid change followed by a period of stasis will yield a rate of intermediate value for the entire interval. Similarly, a period of rapid change in one direction followed by a period of reversal will yield a low net rate. The shorter the interval of measurement, the more likely one is to observe high rates. The longer the interval, the more stasis and evolutionary reversal are likely to be averaged in the result. This effect systematically damps the values of rates calculated over longer and longer intervals."
  },
  {
    "objectID": "listen/journal-club/2023-05-25-coop-book-chapter-9.html",
    "href": "listen/journal-club/2023-05-25-coop-book-chapter-9.html",
    "title": "Chapter 9, Population Genetics by Graham Coop",
    "section": "",
    "text": "Genetic variants in one trait influences multiple other traits through complex pathways. Pleiotropy. Natural selection acts on multiple phenotypes simultaneously.\nBreeder’s equation for multiple traits: \\[\nR_1 = V_{A, 1}\\beta_1 + V_{A, 1, 2}\\beta_2\n\\]\n\\[\nR_2 = V_{A, 2}\\beta_2 + V_{A, 1, 2}\\beta_1\n\\]\n\\[\n\\mathbf{R} = \\mathbf{G} \\mathbf{V}_{\\mathbf{P}}^{-1} \\mathbf{S} = \\mathbf{G}\\mathbf{\\beta}\n\\]"
  },
  {
    "objectID": "listen/journal-club/2023-05-25-coop-book-chapter-9.html#correlated-traits-and-the-response-of-multiple-traits-to-selection",
    "href": "listen/journal-club/2023-05-25-coop-book-chapter-9.html#correlated-traits-and-the-response-of-multiple-traits-to-selection",
    "title": "Chapter 9, Population Genetics by Graham Coop",
    "section": "",
    "text": "Genetic variants in one trait influences multiple other traits through complex pathways. Pleiotropy. Natural selection acts on multiple phenotypes simultaneously.\nBreeder’s equation for multiple traits: \\[\nR_1 = V_{A, 1}\\beta_1 + V_{A, 1, 2}\\beta_2\n\\]\n\\[\nR_2 = V_{A, 2}\\beta_2 + V_{A, 1, 2}\\beta_1\n\\]\n\\[\n\\mathbf{R} = \\mathbf{G} \\mathbf{V}_{\\mathbf{P}}^{-1} \\mathbf{S} = \\mathbf{G}\\mathbf{\\beta}\n\\]"
  },
  {
    "objectID": "listen/journal-club/2023-06-01-otters.html",
    "href": "listen/journal-club/2023-06-01-otters.html",
    "title": "OTTERS TWAS Framework",
    "section": "",
    "text": "OTTERS: a powerful TWAS framework leveraging summary-level reference data\n\nPresented by Teresa Lin\nTraditional TWAS works in three steps: (1) learn from eQTL data, (2) predict gene expression on GWAS data, (3) find association between predicted gene expression and the trait. The main idea of OTTERS is to perform step 1 with eQTL summary statistics. They use difference PRS methods.\n\n\n\nOTTERS\n\n\nWe develop a TWAS framework called OTTERS (Omnibus Transcriptome Test using Expression Reference Summary data) that adapts multiple polygenic risk score (PRS) methods to estimate eQTL weights from summary-level eQTL reference data and conducts an omnibus TWAS."
  },
  {
    "objectID": "listen/group-meeting/2023-04-26-scott-adamson.html",
    "href": "listen/group-meeting/2023-04-26-scott-adamson.html",
    "title": "2023-04-26",
    "section": "",
    "text": "Title: Experimental parameters and their impact on sQTL detection.\n\n\nFunctional interpretation of GWAS:\n\nColocalization between datasets\nIntegration of functional data (Epigenetic, splicing)\nMachine learning predictions\nExperimental follow-up\n\nHow does a variant impact splicing? Splicing (dys)regulation is important for Mendelian and polygenic phenotypes.\n\n10% of human disease associated exonic alleles cause aberrant splicing (Soemedi R, Nat Genet 2017)\nChanges in splicing are likely causes of 35% of Mendelian diseases without a diagnosis from exome or genome sequencing (Cummings BB, Sci Transl Med 2017)\nsQTLs can contribute to GWAS signal more than eQTLs (asthma, breast cancer, heart rate, height, etc.). (Garrido-Martin D, Nat Commun 2021)\n\nScott is trying to develop a new assay, engineering variants on high throughput and see their effect on splicing. There are several parameters that impact sQTL detection.\n\nRead parameters\n\nRead length\nPaired-end vs single-end\n\nSingle cell specific prameters\n\nEditing efficiency\nNumber of cells\nNumber of cells with sQTL variant\nsQTL effect size\nJunction parameters\nNumber of reads per cell\n\n\nDownsample or trim reads and measure the no of junctions. Dataset has 150nt paired end reads sequenced to ~150m.\nNumber of junction spanning reads or junctions detected – Scott is looking at this parameters. Yield per base parie - 0.0015 junctions / bp, Paired-end rate is almost twice that of single-end rate.\nPopulation scale scRNA-seq enables discovery of cell type specific eQTLs. They are shared (and not) with bulk eQTLs. See Yazar et al, Science, 2022. OneK1K.org: Data of 1.27 million peripheral blood mononuclear cells (PMBCs) collected from 982 donors. I think cis-eQTLs will be shared over cell types.\nscRNA-seq sQTL simulator\n\nInput parameters config files fed\nEditing and sQTL workflows\nImplemented in python with pytorch, pyro, tensorQTL\nOptional cell type specific expression and proportions\nTest for sQTL with guide only or with genotype\n\nIdentifying and implementing reasonable default parameters is not simple.\n\nRead count parameters: targeted vs whole transcriptome, implemented as technology specific expression quantiles.\nTranscript-end read bias: Unsure how to implement.\n\nScott is using targeted gene expression (10x ECCITE data, Julia Domingo) for estimating read count parameters. For normal scRNA-seq, he is using a Snakemake pipeline to proces large number of scRNA-seq data.\nHow to estimate adequate base editing efficiency?"
  },
  {
    "objectID": "listen/group-meeting/2023-04-26-scott-adamson.html#presentation-by-scott-adamson",
    "href": "listen/group-meeting/2023-04-26-scott-adamson.html#presentation-by-scott-adamson",
    "title": "2023-04-26",
    "section": "",
    "text": "Title: Experimental parameters and their impact on sQTL detection.\n\n\nFunctional interpretation of GWAS:\n\nColocalization between datasets\nIntegration of functional data (Epigenetic, splicing)\nMachine learning predictions\nExperimental follow-up\n\nHow does a variant impact splicing? Splicing (dys)regulation is important for Mendelian and polygenic phenotypes.\n\n10% of human disease associated exonic alleles cause aberrant splicing (Soemedi R, Nat Genet 2017)\nChanges in splicing are likely causes of 35% of Mendelian diseases without a diagnosis from exome or genome sequencing (Cummings BB, Sci Transl Med 2017)\nsQTLs can contribute to GWAS signal more than eQTLs (asthma, breast cancer, heart rate, height, etc.). (Garrido-Martin D, Nat Commun 2021)\n\nScott is trying to develop a new assay, engineering variants on high throughput and see their effect on splicing. There are several parameters that impact sQTL detection.\n\nRead parameters\n\nRead length\nPaired-end vs single-end\n\nSingle cell specific prameters\n\nEditing efficiency\nNumber of cells\nNumber of cells with sQTL variant\nsQTL effect size\nJunction parameters\nNumber of reads per cell\n\n\nDownsample or trim reads and measure the no of junctions. Dataset has 150nt paired end reads sequenced to ~150m.\nNumber of junction spanning reads or junctions detected – Scott is looking at this parameters. Yield per base parie - 0.0015 junctions / bp, Paired-end rate is almost twice that of single-end rate.\nPopulation scale scRNA-seq enables discovery of cell type specific eQTLs. They are shared (and not) with bulk eQTLs. See Yazar et al, Science, 2022. OneK1K.org: Data of 1.27 million peripheral blood mononuclear cells (PMBCs) collected from 982 donors. I think cis-eQTLs will be shared over cell types.\nscRNA-seq sQTL simulator\n\nInput parameters config files fed\nEditing and sQTL workflows\nImplemented in python with pytorch, pyro, tensorQTL\nOptional cell type specific expression and proportions\nTest for sQTL with guide only or with genotype\n\nIdentifying and implementing reasonable default parameters is not simple.\n\nRead count parameters: targeted vs whole transcriptome, implemented as technology specific expression quantiles.\nTranscript-end read bias: Unsure how to implement.\n\nScott is using targeted gene expression (10x ECCITE data, Julia Domingo) for estimating read count parameters. For normal scRNA-seq, he is using a Snakemake pipeline to proces large number of scRNA-seq data.\nHow to estimate adequate base editing efficiency?"
  },
  {
    "objectID": "listen/group-meeting/2023-08-02-stella-park.html",
    "href": "listen/group-meeting/2023-08-02-stella-park.html",
    "title": "2023-08-02",
    "section": "",
    "text": "Alternative splicing produces different mRNAs. RBPs bind pre-mRNA and regulate splicing.\n\nIdentify both annotated and unannotated RBP isoforms using ENCODE data.\n\nSQANTI3: Transcriptome characterization, Isoform classification\n60% of the isoforms are NIC (novel isoforms with a new combination of known splice sites). 34% of the isoforms are FSM (matches all splice junctions perfectly). Of the NIC isoforms, more than 40% have intron retention, and almost 40% are combination of annotated splice sites. Remaining are combination of annotated splice junctions.\nCPAT: ORF prediction, compares ORF to annotated tranlation start site and uses logistic model for prediction. ~97% ORF sequences of annotated isoforms (Stella’s) match with GENCODE annotated isoforms.\nNMD: Non-sense mediated decay. Frameshifts can give rise to PTCs (premature termination codons) on these undesired isoforms so that they will be dgraded by NMD\n\n\nNucimportv2: Localization Prediction. Prediction nuclear import: infer P(import = true | e), where e is the evidence for query protein, including cNLS scores, NLSdb matches, ppi interactions and SVM scores. cNLS - classical Nuclear Localization Signals. NLS is an amino acid sequence that ‘tags’ a protein for import into the cell nucleus by nuclear transport. ppi - protein-protein interaction.\nMost TFs are predicted to be imported into nucleus. RBPs - Different isoforms of same gene have more variable import probability.\n\n\n\n\nGencode v39 protein coding transcripts\ntappAS Gencode v39 annotation\nList of desired domains\n\nMore than 75% of RNA binding domains are from the zinc finger family.\n\n\n\n\nPTBP1\nRRM\nIntrinsically disordered regions (IDRs)"
  },
  {
    "objectID": "listen/group-meeting/2023-08-02-stella-park.html#presentation-by-stella-park",
    "href": "listen/group-meeting/2023-08-02-stella-park.html#presentation-by-stella-park",
    "title": "2023-08-02",
    "section": "",
    "text": "Alternative splicing produces different mRNAs. RBPs bind pre-mRNA and regulate splicing.\n\nIdentify both annotated and unannotated RBP isoforms using ENCODE data.\n\nSQANTI3: Transcriptome characterization, Isoform classification\n60% of the isoforms are NIC (novel isoforms with a new combination of known splice sites). 34% of the isoforms are FSM (matches all splice junctions perfectly). Of the NIC isoforms, more than 40% have intron retention, and almost 40% are combination of annotated splice sites. Remaining are combination of annotated splice junctions.\nCPAT: ORF prediction, compares ORF to annotated tranlation start site and uses logistic model for prediction. ~97% ORF sequences of annotated isoforms (Stella’s) match with GENCODE annotated isoforms.\nNMD: Non-sense mediated decay. Frameshifts can give rise to PTCs (premature termination codons) on these undesired isoforms so that they will be dgraded by NMD\n\n\nNucimportv2: Localization Prediction. Prediction nuclear import: infer P(import = true | e), where e is the evidence for query protein, including cNLS scores, NLSdb matches, ppi interactions and SVM scores. cNLS - classical Nuclear Localization Signals. NLS is an amino acid sequence that ‘tags’ a protein for import into the cell nucleus by nuclear transport. ppi - protein-protein interaction.\nMost TFs are predicted to be imported into nucleus. RBPs - Different isoforms of same gene have more variable import probability.\n\n\n\n\nGencode v39 protein coding transcripts\ntappAS Gencode v39 annotation\nList of desired domains\n\nMore than 75% of RNA binding domains are from the zinc finger family.\n\n\n\n\nPTBP1\nRRM\nIntrinsically disordered regions (IDRs)"
  },
  {
    "objectID": "listen/group-meeting/2023-04-19-tatsuhiko-naito.html",
    "href": "listen/group-meeting/2023-04-19-tatsuhiko-naito.html",
    "title": "2023-04-19",
    "section": "",
    "text": "Tatsuhiko works on decoding splicing regulatory mechanisms of Alzheimer’s disease microglia using deep learning. The aim is to construct prediction models from brain (microglia) RNA-Seq, train splicing DL model, score to predict variant effect and apply models to ADSP WGS data (n~36k) for rare variant analysis, fine mapping, etc.\n\n\nMicroglia are a type of specialized immune cells and plays a key role in A\\(\\beta\\) aggregation. Katia et al. Nat Genet 2022 showed that there is colocalization between AP/PD risk and microglia QTL effects.\nRare variant test using annotations. Deep learning outperforms conventional methods.\nPangolin\nSimilar architecture as SpliceAI, but improved the prediction accuracy by making predictions for multiple tissues simultaneously. Pangolin NN consist of 16 stacked residal blocks (dilated convolutional layer with skip connections). Takes an input block of 15,000 base pairs and outputs predictions for middle 5000 sites (nucleotides) simultaneously.\nSSE (Splice-Site Strength Estimate)\n\\[\nSSE = \\frac{\\alpha}{(\\alpha + \\beta_1 + \\beta_2)}\n\\]\nPangolin used 4 tissues from 4 different species to improve prediction. He is using microglia data (both in-house and other data) to further improve the learning. He is trying to benchmark his new model against the original Pangolin model.\n\nour data vs original model vs original model + our data\naccuracy improvement by increading sample size\nincluding other species\n\nExpression Modifier Score (EMS): predicting gene expression altering effects of variants trained with fine-mapped eQTL variants (\\(y\\)) and thousands of genomic features (\\(x\\)), \\(y \\sim f(x)\\)."
  },
  {
    "objectID": "listen/group-meeting/2023-04-19-tatsuhiko-naito.html#presentation-by-tatsuhiko-naito",
    "href": "listen/group-meeting/2023-04-19-tatsuhiko-naito.html#presentation-by-tatsuhiko-naito",
    "title": "2023-04-19",
    "section": "",
    "text": "Tatsuhiko works on decoding splicing regulatory mechanisms of Alzheimer’s disease microglia using deep learning. The aim is to construct prediction models from brain (microglia) RNA-Seq, train splicing DL model, score to predict variant effect and apply models to ADSP WGS data (n~36k) for rare variant analysis, fine mapping, etc.\n\n\nMicroglia are a type of specialized immune cells and plays a key role in A\\(\\beta\\) aggregation. Katia et al. Nat Genet 2022 showed that there is colocalization between AP/PD risk and microglia QTL effects.\nRare variant test using annotations. Deep learning outperforms conventional methods.\nPangolin\nSimilar architecture as SpliceAI, but improved the prediction accuracy by making predictions for multiple tissues simultaneously. Pangolin NN consist of 16 stacked residal blocks (dilated convolutional layer with skip connections). Takes an input block of 15,000 base pairs and outputs predictions for middle 5000 sites (nucleotides) simultaneously.\nSSE (Splice-Site Strength Estimate)\n\\[\nSSE = \\frac{\\alpha}{(\\alpha + \\beta_1 + \\beta_2)}\n\\]\nPangolin used 4 tissues from 4 different species to improve prediction. He is using microglia data (both in-house and other data) to further improve the learning. He is trying to benchmark his new model against the original Pangolin model.\n\nour data vs original model vs original model + our data\naccuracy improvement by increading sample size\nincluding other species\n\nExpression Modifier Score (EMS): predicting gene expression altering effects of variants trained with fine-mapped eQTL variants (\\(y\\)) and thousands of genomic features (\\(x\\)), \\(y \\sim f(x)\\)."
  },
  {
    "objectID": "listen/group-meeting/2023-05-10-brielin-brown.html",
    "href": "listen/group-meeting/2023-05-10-brielin-brown.html",
    "title": "2023-05-10",
    "section": "",
    "text": "MESA (Multi-ethnic study of Atherosclerosis) - NHLBI TOPMed - Multi-omic analysis but also multi-phenotype, multi-tissue, multi-ancestry, multi-center. NHLBI TOPMed generate multi-omic data for tens of thousands of patients. MESA multi-omic pilot. Frozen blood samples - plasma for proteins, metabolites - PBMCs (monocytes, T-cells) for gene expression - Whole blood for methylation.\n\\[X_m \\sim N(0, I_{k_m})\\] \\[Z \\sim N(0, I_d)\\] \\[Y_m \\sim N(X_m L_m^T + ZW_m^T, \\Phi_m)\\]\nhidden private - \\(X_m\\), hidden shared - \\(Z\\), observed multimodal data - \\(Y_m\\)\n\n\n\nChatGPT could succesfully provide functions of genes, but provided wrong answers about the methylation markers.\n\n\n\n\nMulti-modal auto-encoder. Could not find factors reliably.\nMOFA (Multi-omics factor analysis). Problem with unbalanced weight. Puts more weight on dataset with more features (e.g. methylation data contains ~50,000 features compared to expression data with ~20,000 features).\n\n\n\n\nDirected graph on 149 UK Biobank phenotypes is highly connected."
  },
  {
    "objectID": "listen/group-meeting/2023-05-10-brielin-brown.html#presentation-by-brielin-brown",
    "href": "listen/group-meeting/2023-05-10-brielin-brown.html#presentation-by-brielin-brown",
    "title": "2023-05-10",
    "section": "",
    "text": "MESA (Multi-ethnic study of Atherosclerosis) - NHLBI TOPMed - Multi-omic analysis but also multi-phenotype, multi-tissue, multi-ancestry, multi-center. NHLBI TOPMed generate multi-omic data for tens of thousands of patients. MESA multi-omic pilot. Frozen blood samples - plasma for proteins, metabolites - PBMCs (monocytes, T-cells) for gene expression - Whole blood for methylation.\n\\[X_m \\sim N(0, I_{k_m})\\] \\[Z \\sim N(0, I_d)\\] \\[Y_m \\sim N(X_m L_m^T + ZW_m^T, \\Phi_m)\\]\nhidden private - \\(X_m\\), hidden shared - \\(Z\\), observed multimodal data - \\(Y_m\\)\n\n\n\nChatGPT could succesfully provide functions of genes, but provided wrong answers about the methylation markers.\n\n\n\n\nMulti-modal auto-encoder. Could not find factors reliably.\nMOFA (Multi-omics factor analysis). Problem with unbalanced weight. Puts more weight on dataset with more features (e.g. methylation data contains ~50,000 features compared to expression data with ~20,000 features).\n\n\n\n\nDirected graph on 149 UK Biobank phenotypes is highly connected."
  },
  {
    "objectID": "listen/group-meeting/2023-07-12-teresa-lin.html",
    "href": "listen/group-meeting/2023-07-12-teresa-lin.html",
    "title": "2023-07-12",
    "section": "",
    "text": "Finemapping using SuSiE\nAdding functional annotations can improve fine-mapping (?)\n\n\n\n\nstill not used in clinical setting.\nlow transferability.\ndifferences in LD structure, allele frequency and causal effect size.\n\n\n\n\nSummary stat \\(\\rightarrow\\) functional finemapping (PolyFun), [use baseline annotations (187), Roadmap (90), DeepSea (75), Glass lab (10), Enformer (66), Glass lab Enformer (6)] \\(\\rightarrow\\) statistical finemapping (SuSiE) \\(\\rightarrow\\) PRS, PLINK (clumping + p-threshold) / PolyFun-pred \\(\\leftarrow\\) adsp genotype/phenotype.\nBaseline annotations \\(\\rightarrow\\) MAF bins, LD-related annotations for common and rare SNPs.\nRoadmap \\(\\rightarrow\\) DNase, H3K27ax, H3K4me3, H3k4me1\nGlass lab \\(\\rightarrow\\) Microglia ATAC-Seq, Neuron H3K27ax, microglia enhancer ATAC-Seq, microglia H3K4me3, oligodendrocyte H3K27ac\nGlass lab Enformer \\(\\rightarrow\\) Neuron enhancer, microglia enhancer, microglia enhancer ATAC-Seq, etc.\n\n\n\n\\[\n\\beta_j \\sim \\mathcal{N}\\left( 0, \\Psi_j \\right), \\quad \\Psi_j ~ G\n\\]"
  },
  {
    "objectID": "listen/group-meeting/2023-07-12-teresa-lin.html#presentation-by-teresa-lin",
    "href": "listen/group-meeting/2023-07-12-teresa-lin.html#presentation-by-teresa-lin",
    "title": "2023-07-12",
    "section": "",
    "text": "Finemapping using SuSiE\nAdding functional annotations can improve fine-mapping (?)\n\n\n\n\nstill not used in clinical setting.\nlow transferability.\ndifferences in LD structure, allele frequency and causal effect size.\n\n\n\n\nSummary stat \\(\\rightarrow\\) functional finemapping (PolyFun), [use baseline annotations (187), Roadmap (90), DeepSea (75), Glass lab (10), Enformer (66), Glass lab Enformer (6)] \\(\\rightarrow\\) statistical finemapping (SuSiE) \\(\\rightarrow\\) PRS, PLINK (clumping + p-threshold) / PolyFun-pred \\(\\leftarrow\\) adsp genotype/phenotype.\nBaseline annotations \\(\\rightarrow\\) MAF bins, LD-related annotations for common and rare SNPs.\nRoadmap \\(\\rightarrow\\) DNase, H3K27ax, H3K4me3, H3k4me1\nGlass lab \\(\\rightarrow\\) Microglia ATAC-Seq, Neuron H3K27ax, microglia enhancer ATAC-Seq, microglia H3K4me3, oligodendrocyte H3K27ac\nGlass lab Enformer \\(\\rightarrow\\) Neuron enhancer, microglia enhancer, microglia enhancer ATAC-Seq, etc.\n\n\n\n\\[\n\\beta_j \\sim \\mathcal{N}\\left( 0, \\Psi_j \\right), \\quad \\Psi_j ~ G\n\\]"
  },
  {
    "objectID": "listen/group-meeting/2023-04-14-adsp-group-meeting.html",
    "href": "listen/group-meeting/2023-04-14-adsp-group-meeting.html",
    "title": "2023-04-14",
    "section": "",
    "text": "Knowles Lab and Raj Lab (Towfique Raj) works together on the Alzheimer’s Disease Sequencing Project (ADSP). Here are my notes on the in-person joint meeting.\n\n\n17k WGS, 40 cohorts, mix of ancestry. Find new genes, alleles, etc for AD.\n\nFunctional genomics. xQTL (Gao Wang and Phil de Jager). Multi-omic functional assessment of novel AD variants using single-cell (Montine, Kundaje, Montgomery).\nAI / ML: neuro-imaging. Olivier Lichtarge - cognitive computing of AD genes and risk. Wein Pan - causal and integrative dep learning for AD genetics. Paul Thompson - mega-grant.\nStructural variant WG.\n\n\n\nApply deep learning techniques to predict and interpret the functional effects of AD variants, gene regulation, gene networks (RNA-Seq, ATAC-Seq, cell-type specific), trans-eQTL, prioritization of genes and pathways (finemapping?).\n\n\n\n\nTraining functional genomics models in PyTorch.\nDL models predict functional genomic assays as a function of sequence. DNA -&gt; Convolution Layers -&gt; Dilated convolution layers -&gt; Prediction.\nKelley et al, Genome Research, 2018.\nFor genomics, the goal is two-fold: (1) classification - predict called peaks for a particular assay, (2) regression - predict read counts of that assay.\nBias correction is important. read counts - assay bias. Basenji - GC bias. BPNet - bias correction model. How do this bias correction methods work?\nInput format - one hot encoding of DNA sequence.\nOutput - generate bins of read counts for each functional genomics assay.\nCreate Dataloader - tiled matrix of DNA. Split data for training / validation / test.\n\n\n\nCell-type specific distal genetic regulation.\nGoal: cis and trans eQTLs for a massive resource of uniformly processed RNA-Seq and genotype data (BigBrain) - expression, isoforms and splicing.\nThere are several cohorts and the team has calculated summary statistics for cis-eQTLs in most of them.\nFor one particular cohort, they found very few sQTLs. Is there someting wrong with the ROSMAP cohort? One potential source of error could be because ROSMAP samples are reverse-stranded.\nThey are planning to extend to trans-eQTLs.\nLink\nChirag asked about isoform TWAS.\n\n\n\nImpact of genetic variants on TF binding and chromatin in AD in cell-type specific ways.\nGWAS identified 75+ AD associated genetic loci. Myeloid cells are important.\nAD risk loci mediated by gene expression in microglia. MiGA (Microglia Genomic Atlas). Paiva Lopes, … Raj, Nat Genet.\ncaQTLs - chromatin accessibility.\nbQTLs - TF binding QTLs, from novel pooled ChIP-Seq.\nHarmonize bulk, sorted and single-cell/nuclei ATAC-seq datasets from neuronal and non-neuronal cells, enriching for myeloid cells, create chromatin accesibility profiles. About 1063 total donors bulk, 179 total donors in single nuclei.\nHow myeloid chromatin states compare to other cell types?\nGeschwind lab - ATAC-seq bulk - fetal brains, PHNPC cell types, 92 donors - NPD\nMonocytes are good proxy for microglia.\nsnMultiomics - RNA, ATAC. Also genotyped.\n\n\n\nEvolutionary conservation of alternative splicing. Generally AS is quite species specific. Mazin et al, Nat Genet. 2021 showed three cassette exons in DLG3 that are highly conserved AS events in the brain. But, we know little about splicing conservation in single cells.\nHow well can we measure AS in single cell? Olivieri et al, eLife 2021, Hardwick et al, Nat Biotechnol, 2022\nSPLiT-Seq with PolyDT + random hexamer primers provide better coverage than 10X genomics with polyDT primers.\nZooBrain: regulatory conservation across vertebrate brains. Satija group. How to define splicing events from RNA-Seq data?\nAre junction counts zero inflated? 39% of junctions show zero-inflation under a global binomial model. Whereas only ~1% show zero inflation with individual binomial model.\nDo PBMCs undergo differential splicing?\nKarin is also looking at topic-modeling of single-cells.\n\n\n\nAssessing the effect of different variables on gene expression and define appropriate covariates for sQTL analysis.\nsplicing QTLs are variants that modify alternative splicing events. She is using 9 cohorts (n ~ 5.5k).\nFirst 3 PCs of the gene expression explain more than 50% variation. She thinks that cohort and tissue types are the major driver of the variation. Needs to be accounted for in the sQTL analysis. She also checked for library preparation as a possible covariate, she checked for number of reads and sex as covariates.\nCan we try using any unsupervised method for predicting the hidden covariates?\nIdentify a good approach to account for covariate effects while performing sQTL analysis.\n\n\n\nImproving rare variant association tests using functional annotations.\nShe talked about Functional Score Test (FST). We expect the FST to capture the signature of functional annotation The FST does not appear to be capturing the difference between known AD genes and random genes. Also see my notes on her group meeting earlier this week.\n\n\n\nWhy microglia? Involved in A\\(\\beta\\) plaque formation.\nThe project aims to contruct prediction model. Training: Brain (microglia) RNA-Seq. Learn DL model and then predict.\nPangolin - improving multiple tissue prediction by combining different species. It is trained on 4 species, human rhesus, mouse and rat. 10,000 base pair sequence context, dilated residual convolution layers, and predict splice probability. Pangolin outperforms SpliceAI.\n\n\n\nPangolin\n\n\nTatsuhiko showed the pipeline for generating training and test data for Pangolin. Essentially, the idea is to find the splice sites and find association with reference genome. He will use microglia data from other species, published elsewhere recently. He discussed a detailed benchmarking plan for comparison of his new microglia data training with the origin training. The expectation is to improve accuracy with increasing sample size and species.\n\n\n\nA-to-I RNA editing is abundant in the brain and implicated in disease.\n\n\n\nRNA editing\n\n\n\n\nn = 11801 (!)\nMethods - RNA editing events called with Jacusa2. edQTL mapping with TensorQTL.\nMeta-analysis drastically improves discovery revealing 21620 edQTLs in 5866 genes. But, he is observing many “singleton” sites, that is, associations observed in single cohorts. edSites occur in hyper-editing clusters.\nColocalization analysis.\nedQTLs colocalize with Parkinson’s disease risk SNPs.\n\n\n\n\n\n\n\nPipeline using Wightman summary stat, QC, functional fine-mapping (PolyFun) and statistical fine-mapping (SuSiE), finally Polygenic Risk Score (Plink with clumping + p threshold).\nTeresa is comparing the accuracy of finemapping by looking at the heritability enrichment obtained from the finemapped variants, as well as using PRS performance of the finemapped variants.\nQuestion: Is the PRS score measured on separate test data?\n\n\n\nMeta-analysis of myeloid cell eQTLs.\nUse the myeloid cells from the BigBrain project.\nMany eQTLs colocalize with AD GWAS loci.\nHe wants to develop framework to understand enrichment for eQTL (and sQTL) data. - Approach 1: fine map and use results as continuous annotation, assess heritability via LD score regression. - Approach 2: run mediated expression score regression (MESC)."
  },
  {
    "objectID": "listen/group-meeting/2023-04-14-adsp-group-meeting.html#adsp-group-meeting-at-icahn-institute",
    "href": "listen/group-meeting/2023-04-14-adsp-group-meeting.html#adsp-group-meeting-at-icahn-institute",
    "title": "2023-04-14",
    "section": "",
    "text": "Knowles Lab and Raj Lab (Towfique Raj) works together on the Alzheimer’s Disease Sequencing Project (ADSP). Here are my notes on the in-person joint meeting.\n\n\n17k WGS, 40 cohorts, mix of ancestry. Find new genes, alleles, etc for AD.\n\nFunctional genomics. xQTL (Gao Wang and Phil de Jager). Multi-omic functional assessment of novel AD variants using single-cell (Montine, Kundaje, Montgomery).\nAI / ML: neuro-imaging. Olivier Lichtarge - cognitive computing of AD genes and risk. Wein Pan - causal and integrative dep learning for AD genetics. Paul Thompson - mega-grant.\nStructural variant WG.\n\n\n\nApply deep learning techniques to predict and interpret the functional effects of AD variants, gene regulation, gene networks (RNA-Seq, ATAC-Seq, cell-type specific), trans-eQTL, prioritization of genes and pathways (finemapping?).\n\n\n\n\nTraining functional genomics models in PyTorch.\nDL models predict functional genomic assays as a function of sequence. DNA -&gt; Convolution Layers -&gt; Dilated convolution layers -&gt; Prediction.\nKelley et al, Genome Research, 2018.\nFor genomics, the goal is two-fold: (1) classification - predict called peaks for a particular assay, (2) regression - predict read counts of that assay.\nBias correction is important. read counts - assay bias. Basenji - GC bias. BPNet - bias correction model. How do this bias correction methods work?\nInput format - one hot encoding of DNA sequence.\nOutput - generate bins of read counts for each functional genomics assay.\nCreate Dataloader - tiled matrix of DNA. Split data for training / validation / test.\n\n\n\nCell-type specific distal genetic regulation.\nGoal: cis and trans eQTLs for a massive resource of uniformly processed RNA-Seq and genotype data (BigBrain) - expression, isoforms and splicing.\nThere are several cohorts and the team has calculated summary statistics for cis-eQTLs in most of them.\nFor one particular cohort, they found very few sQTLs. Is there someting wrong with the ROSMAP cohort? One potential source of error could be because ROSMAP samples are reverse-stranded.\nThey are planning to extend to trans-eQTLs.\nLink\nChirag asked about isoform TWAS.\n\n\n\nImpact of genetic variants on TF binding and chromatin in AD in cell-type specific ways.\nGWAS identified 75+ AD associated genetic loci. Myeloid cells are important.\nAD risk loci mediated by gene expression in microglia. MiGA (Microglia Genomic Atlas). Paiva Lopes, … Raj, Nat Genet.\ncaQTLs - chromatin accessibility.\nbQTLs - TF binding QTLs, from novel pooled ChIP-Seq.\nHarmonize bulk, sorted and single-cell/nuclei ATAC-seq datasets from neuronal and non-neuronal cells, enriching for myeloid cells, create chromatin accesibility profiles. About 1063 total donors bulk, 179 total donors in single nuclei.\nHow myeloid chromatin states compare to other cell types?\nGeschwind lab - ATAC-seq bulk - fetal brains, PHNPC cell types, 92 donors - NPD\nMonocytes are good proxy for microglia.\nsnMultiomics - RNA, ATAC. Also genotyped.\n\n\n\nEvolutionary conservation of alternative splicing. Generally AS is quite species specific. Mazin et al, Nat Genet. 2021 showed three cassette exons in DLG3 that are highly conserved AS events in the brain. But, we know little about splicing conservation in single cells.\nHow well can we measure AS in single cell? Olivieri et al, eLife 2021, Hardwick et al, Nat Biotechnol, 2022\nSPLiT-Seq with PolyDT + random hexamer primers provide better coverage than 10X genomics with polyDT primers.\nZooBrain: regulatory conservation across vertebrate brains. Satija group. How to define splicing events from RNA-Seq data?\nAre junction counts zero inflated? 39% of junctions show zero-inflation under a global binomial model. Whereas only ~1% show zero inflation with individual binomial model.\nDo PBMCs undergo differential splicing?\nKarin is also looking at topic-modeling of single-cells.\n\n\n\nAssessing the effect of different variables on gene expression and define appropriate covariates for sQTL analysis.\nsplicing QTLs are variants that modify alternative splicing events. She is using 9 cohorts (n ~ 5.5k).\nFirst 3 PCs of the gene expression explain more than 50% variation. She thinks that cohort and tissue types are the major driver of the variation. Needs to be accounted for in the sQTL analysis. She also checked for library preparation as a possible covariate, she checked for number of reads and sex as covariates.\nCan we try using any unsupervised method for predicting the hidden covariates?\nIdentify a good approach to account for covariate effects while performing sQTL analysis.\n\n\n\nImproving rare variant association tests using functional annotations.\nShe talked about Functional Score Test (FST). We expect the FST to capture the signature of functional annotation The FST does not appear to be capturing the difference between known AD genes and random genes. Also see my notes on her group meeting earlier this week.\n\n\n\nWhy microglia? Involved in A\\(\\beta\\) plaque formation.\nThe project aims to contruct prediction model. Training: Brain (microglia) RNA-Seq. Learn DL model and then predict.\nPangolin - improving multiple tissue prediction by combining different species. It is trained on 4 species, human rhesus, mouse and rat. 10,000 base pair sequence context, dilated residual convolution layers, and predict splice probability. Pangolin outperforms SpliceAI.\n\n\n\nPangolin\n\n\nTatsuhiko showed the pipeline for generating training and test data for Pangolin. Essentially, the idea is to find the splice sites and find association with reference genome. He will use microglia data from other species, published elsewhere recently. He discussed a detailed benchmarking plan for comparison of his new microglia data training with the origin training. The expectation is to improve accuracy with increasing sample size and species.\n\n\n\nA-to-I RNA editing is abundant in the brain and implicated in disease.\n\n\n\nRNA editing\n\n\n\n\nn = 11801 (!)\nMethods - RNA editing events called with Jacusa2. edQTL mapping with TensorQTL.\nMeta-analysis drastically improves discovery revealing 21620 edQTLs in 5866 genes. But, he is observing many “singleton” sites, that is, associations observed in single cohorts. edSites occur in hyper-editing clusters.\nColocalization analysis.\nedQTLs colocalize with Parkinson’s disease risk SNPs.\n\n\n\n\n\n\n\nPipeline using Wightman summary stat, QC, functional fine-mapping (PolyFun) and statistical fine-mapping (SuSiE), finally Polygenic Risk Score (Plink with clumping + p threshold).\nTeresa is comparing the accuracy of finemapping by looking at the heritability enrichment obtained from the finemapped variants, as well as using PRS performance of the finemapped variants.\nQuestion: Is the PRS score measured on separate test data?\n\n\n\nMeta-analysis of myeloid cell eQTLs.\nUse the myeloid cells from the BigBrain project.\nMany eQTLs colocalize with AD GWAS loci.\nHe wants to develop framework to understand enrichment for eQTL (and sQTL) data. - Approach 1: fine map and use results as continuous annotation, assess heritability via LD score regression. - Approach 2: run mediated expression score regression (MESC)."
  },
  {
    "objectID": "listen/group-meeting/2023-06-28-claire-harbison.html",
    "href": "listen/group-meeting/2023-06-28-claire-harbison.html",
    "title": "2023-06-28",
    "section": "",
    "text": "Alternative splicing of RNA causes different isoforms of the same gene.\nThe idea is to knockdown isoforms and see its effects on phenotypes. How to knowckdown the isoforms?\nCas13 has been shown to target and knockdown exonic regions of RNA. See East-Seletsky et al. and Abudayyah et al.\nCheng et al explored Cas13 guide activity, predicting gRNAs with ML algorithms. Model provided 8 guides across two junctions with singnifcant knockdown of COP1.\n\nWhat is Cas13 guide activity?\nType VI CRISPR enzymes are RNA-targeting proteins with nuclease activity that enable specific and robust target gene knockdown without altering the genome. Cas13 proteins are guided to their target RNAs by a single CRISPR RNA (crRNA) composed of a direct repeat (DR) stem loop and a spacer sequence (gRNA) that mediates target recognition by RNA–RNA hybridization.\nWhat is splice junction?\nIn the splicing of RNA, the site of a former intron in a mature mRNA.\nWhat is the expression level of COP1?\nAround 50tpm in a regular cell.\n\nPredicted guides span the junctions to see if the guide placement impacts knockdown.\nThey took the 8 guides, prepare the Cas13 guide RNAs, and added it to the media. Activate Cas13 with doxycycline, Extract cells, extract RNA and perform RT-qPCR. The drug doxycycline activates Cas13 when added, and deactivates when removed from the media. - This is reversible, but there is a time delay of days.\nThere were 4 guides at common junction, and 4 guides at unique junction. The knockdown was around 30% to 50% in A-375 cell lines.\nWhat other parameters could impact knockdown?\n\nCell type\nBiological replicates\nTime of Cas13 activity\n\nKnockdown in stem cells was more promising, where the expression reduced to around 5% to 25%. Guides targeting common junctions generally performed better than guides targeting unique juctions. They all work decently.\nIn HEKs cells (human embryonic kidney), the knockdown was better than the first experiment and worse than the stem cells.\nCas13 performs similarly across biological replicates in HEKs cells.\nFor common junction, 24 hours of Cas13 activity is the sweet spot. But for unique junctions, 48 hours of Cas13 activity is the sweet spot. (?) The variability is very minimal, could be a technical noise. One could maybe pick any time duration.\n\nDoes the prediction of guide RNAs also depend on cell type?\nA predicted guide RNA should work across all cell types. It depends on the secondary structure of the target RNA."
  },
  {
    "objectID": "listen/group-meeting/2023-06-28-claire-harbison.html#presentation-by-claire-harbison",
    "href": "listen/group-meeting/2023-06-28-claire-harbison.html#presentation-by-claire-harbison",
    "title": "2023-06-28",
    "section": "",
    "text": "Alternative splicing of RNA causes different isoforms of the same gene.\nThe idea is to knockdown isoforms and see its effects on phenotypes. How to knowckdown the isoforms?\nCas13 has been shown to target and knockdown exonic regions of RNA. See East-Seletsky et al. and Abudayyah et al.\nCheng et al explored Cas13 guide activity, predicting gRNAs with ML algorithms. Model provided 8 guides across two junctions with singnifcant knockdown of COP1.\n\nWhat is Cas13 guide activity?\nType VI CRISPR enzymes are RNA-targeting proteins with nuclease activity that enable specific and robust target gene knockdown without altering the genome. Cas13 proteins are guided to their target RNAs by a single CRISPR RNA (crRNA) composed of a direct repeat (DR) stem loop and a spacer sequence (gRNA) that mediates target recognition by RNA–RNA hybridization.\nWhat is splice junction?\nIn the splicing of RNA, the site of a former intron in a mature mRNA.\nWhat is the expression level of COP1?\nAround 50tpm in a regular cell.\n\nPredicted guides span the junctions to see if the guide placement impacts knockdown.\nThey took the 8 guides, prepare the Cas13 guide RNAs, and added it to the media. Activate Cas13 with doxycycline, Extract cells, extract RNA and perform RT-qPCR. The drug doxycycline activates Cas13 when added, and deactivates when removed from the media. - This is reversible, but there is a time delay of days.\nThere were 4 guides at common junction, and 4 guides at unique junction. The knockdown was around 30% to 50% in A-375 cell lines.\nWhat other parameters could impact knockdown?\n\nCell type\nBiological replicates\nTime of Cas13 activity\n\nKnockdown in stem cells was more promising, where the expression reduced to around 5% to 25%. Guides targeting common junctions generally performed better than guides targeting unique juctions. They all work decently.\nIn HEKs cells (human embryonic kidney), the knockdown was better than the first experiment and worse than the stem cells.\nCas13 performs similarly across biological replicates in HEKs cells.\nFor common junction, 24 hours of Cas13 activity is the sweet spot. But for unique junctions, 48 hours of Cas13 activity is the sweet spot. (?) The variability is very minimal, could be a technical noise. One could maybe pick any time duration.\n\nDoes the prediction of guide RNAs also depend on cell type?\nA predicted guide RNA should work across all cell types. It depends on the secondary structure of the target RNA."
  },
  {
    "objectID": "listen/seminar/2023-05-04-julia-domingo.html",
    "href": "listen/seminar/2023-05-04-julia-domingo.html",
    "title": "Julia Domingo, Modulation of TF Levels",
    "section": "",
    "text": "She started talking about the genotype-to-phenotype problem. Molecular phenotype vs cellular phenotype. Molecular phenotype – changes in expression of downstream genes. How cis-gene dosage modifies the trans-gene dosage? –&gt; Modulate the expression of few genes and look at the modulation of many targeted gene expressions.\nMorris et al, Science, 2023 discovered target genes and pathways at GWAS loci by pooled single-cell CRISPR screens. Some cis-genes are GF1B, NFE2, MYB, TET2.\n\n\nECCITE-seq framework\nHTOs, targeted cDNA, sgRNAs\nCRISPRi and CRISPRa\nQC and demultiplexing pipeline:\n\ncDNA\nGDOs (sgRNAs)\nHTOs\n\nQuestions and Answers:\n1. What is the best unbiased approach to modulate gene expression?\n\nWide range of fold changes spanned using different types of sgRNAs. Number of single cells, ON-/OFF- guide target activity don’t affect gene expression.\n\n2. What are the key determinants of dosage effects in cis?\n\nDistance to TSS, Local chromatin environment\n\n3. How do trans effects relate to dosage changes of the cis gene?\n\nCis gene fold change.\nSigmoid model is a good fit for all the 4 genes (GF1B, NFE2, MYB, TET2).\n\n4. Are transcriptional non-linear dosage response important for downstream phenotype, complex traits or disease?\n\nCorrelation fold changes with mean gene expression. Cell differentiation “pseudophenotype”.\nDisease and GWAS genes are enriched in non-linear responses.\n\n5. Are dosage response of trans genes correlated to gene or network properties?\n\nRelationship with transcriptional network properties, Mariia Minaeva"
  },
  {
    "objectID": "listen/seminar/2023-05-04-julia-domingo.html#julia-domingo",
    "href": "listen/seminar/2023-05-04-julia-domingo.html#julia-domingo",
    "title": "Julia Domingo, Modulation of TF Levels",
    "section": "",
    "text": "She started talking about the genotype-to-phenotype problem. Molecular phenotype vs cellular phenotype. Molecular phenotype – changes in expression of downstream genes. How cis-gene dosage modifies the trans-gene dosage? –&gt; Modulate the expression of few genes and look at the modulation of many targeted gene expressions.\nMorris et al, Science, 2023 discovered target genes and pathways at GWAS loci by pooled single-cell CRISPR screens. Some cis-genes are GF1B, NFE2, MYB, TET2.\n\n\nECCITE-seq framework\nHTOs, targeted cDNA, sgRNAs\nCRISPRi and CRISPRa\nQC and demultiplexing pipeline:\n\ncDNA\nGDOs (sgRNAs)\nHTOs\n\nQuestions and Answers:\n1. What is the best unbiased approach to modulate gene expression?\n\nWide range of fold changes spanned using different types of sgRNAs. Number of single cells, ON-/OFF- guide target activity don’t affect gene expression.\n\n2. What are the key determinants of dosage effects in cis?\n\nDistance to TSS, Local chromatin environment\n\n3. How do trans effects relate to dosage changes of the cis gene?\n\nCis gene fold change.\nSigmoid model is a good fit for all the 4 genes (GF1B, NFE2, MYB, TET2).\n\n4. Are transcriptional non-linear dosage response important for downstream phenotype, complex traits or disease?\n\nCorrelation fold changes with mean gene expression. Cell differentiation “pseudophenotype”.\nDisease and GWAS genes are enriched in non-linear responses.\n\n5. Are dosage response of trans genes correlated to gene or network properties?\n\nRelationship with transcriptional network properties, Mariia Minaeva"
  },
  {
    "objectID": "listen/seminar/2023-06-01-william-fairbrother.html",
    "href": "listen/seminar/2023-06-01-william-fairbrother.html",
    "title": "William Fairbrother, Hotspot Exons",
    "section": "",
    "text": "Splicing reaction occurs by nucleophilic attack of the phosphate group by -OH groups at the 5’ site followed by the 3’ site. It is catalyzed by a large complex called the spliceosome. See CSH Perspectives in Biology, 3(7) 2011.\nIntron removal in multi-exon contect may differ from existing model. Multiple splicing events associated with intron removal: (1) Concurrent splicing (Staley lab), (2) Recursive splicing (Javier Lopez), (3) Stochastic splicing (Wan et al Cell 2021, Larson lab).\nAn average human coding gene has 9.8 exons. Exon skipping alone could generate \\(2^{10}\\) variations. Alternative splicing expands human proteome. See Lee and Rio, 2015. Also, more recently 300K RNA-Seq experiment.\nSequence Read Archive (SRA) reveals numerous splicing events outside the annotation.\nWhen a splice site is disrupted by mutation, 54% of the time the spliceosome uses the next best choice. Dawes et. al, Nature Genetics, 55, 324-332 (2023)\nMPRA finds a 10 fold excess of 5’s and 3’s in typical transcript.\nFairbrother lab looks at splicing defects. Mutations in exons can disrupt splice sites.\nThe strength of flanking exons affects sensitivity to splicing mutations.\n\nSome diseases are enriched in splicing nutations.\nSplicing mutations are distributed non-uniformly.\nExon level features are more predictive of exonic splicing mutations than local motif features. Hotspot exons have higher GBM score than non-hotspot exons.\nSpliceAI predicted hotspot exons are more vulnerable to splicing inhibitor PlaB.\nIn addition to exon features, flanking exon strength can affect nutation.\nOnly weak exons are affected by flanking exon strengtg,\nTest ASO oligos. ASO targeting flanking exon can restore splicng."
  },
  {
    "objectID": "listen/seminar/2023-06-01-william-fairbrother.html#william-fairbrother-brown-university",
    "href": "listen/seminar/2023-06-01-william-fairbrother.html#william-fairbrother-brown-university",
    "title": "William Fairbrother, Hotspot Exons",
    "section": "",
    "text": "Splicing reaction occurs by nucleophilic attack of the phosphate group by -OH groups at the 5’ site followed by the 3’ site. It is catalyzed by a large complex called the spliceosome. See CSH Perspectives in Biology, 3(7) 2011.\nIntron removal in multi-exon contect may differ from existing model. Multiple splicing events associated with intron removal: (1) Concurrent splicing (Staley lab), (2) Recursive splicing (Javier Lopez), (3) Stochastic splicing (Wan et al Cell 2021, Larson lab).\nAn average human coding gene has 9.8 exons. Exon skipping alone could generate \\(2^{10}\\) variations. Alternative splicing expands human proteome. See Lee and Rio, 2015. Also, more recently 300K RNA-Seq experiment.\nSequence Read Archive (SRA) reveals numerous splicing events outside the annotation.\nWhen a splice site is disrupted by mutation, 54% of the time the spliceosome uses the next best choice. Dawes et. al, Nature Genetics, 55, 324-332 (2023)\nMPRA finds a 10 fold excess of 5’s and 3’s in typical transcript.\nFairbrother lab looks at splicing defects. Mutations in exons can disrupt splice sites.\nThe strength of flanking exons affects sensitivity to splicing mutations.\n\nSome diseases are enriched in splicing nutations.\nSplicing mutations are distributed non-uniformly.\nExon level features are more predictive of exonic splicing mutations than local motif features. Hotspot exons have higher GBM score than non-hotspot exons.\nSpliceAI predicted hotspot exons are more vulnerable to splicing inhibitor PlaB.\nIn addition to exon features, flanking exon strength can affect nutation.\nOnly weak exons are affected by flanking exon strengtg,\nTest ASO oligos. ASO targeting flanking exon can restore splicng."
  },
  {
    "objectID": "read/index.html",
    "href": "read/index.html",
    "title": "Read",
    "section": "",
    "text": "In this section, I write down the most important concepts and ideas that I learn from reading journal articles, reviews, books, blogs and tutorials."
  },
  {
    "objectID": "code/2023-09-19-ashwini-setup.html",
    "href": "code/2023-09-19-ashwini-setup.html",
    "title": "Setup Ashwini",
    "section": "",
    "text": "Running documentation for the server setup in Ashwini. Here are some Linux references which I find useful:"
  },
  {
    "objectID": "code/2023-09-19-ashwini-setup.html#internet-connection",
    "href": "code/2023-09-19-ashwini-setup.html#internet-connection",
    "title": "Setup Ashwini",
    "section": "Internet Connection",
    "text": "Internet Connection\nFor overview see, Configuring Networks on Ubuntu Server.\n\nCheck ethernet name:\n\nip -d address\n\nCreate configuration in /etc/netplan/01-netcfg.yaml.\n\nnetwork:\n  version: 2\n  renderer: networkd\n  ethernets:\n    # interface name\n    ens18:\n      dhcp4: false\n      # IP address / subnet mask\n      # removed exact numbers for security\n      addresses:\n        - xxx.xxx.xxx.xxx/25\n      # default gateway\n      routes:\n        - to: default\n          via: xxx.xxx.xxx.xxx\n      nameservers:\n        addresses:\n        - 1.1.1.1\n        - 8.8.8.8\n        - 8.8.4.4\n      dhcp6: false\n\nApply configuration\n\nsudo netplan --debug apply\n\nPing local IP and external IP to check\n\nping xxx.xxx.xxx.xxx\nping google.com\n\nI like to see what is happening!\n\nip -s link show ens18\nip route show"
  },
  {
    "objectID": "code/2023-09-19-ashwini-setup.html#update-os",
    "href": "code/2023-09-19-ashwini-setup.html#update-os",
    "title": "Setup Ashwini",
    "section": "Update OS",
    "text": "Update OS\nsudo apt update\nsudo apt upgrade\nsudo reboot\nsudo apt install vim build-essential git"
  },
  {
    "objectID": "code/2023-09-19-ashwini-setup.html#purge-snap",
    "href": "code/2023-09-19-ashwini-setup.html#purge-snap",
    "title": "Setup Ashwini",
    "section": "Purge snap",
    "text": "Purge snap\nI do not like things happening in the background without my knowledge. For me, the first thing to do after a fresh install is to remove snap.\nsudo snap list\nsudo systemctl disable snapd.service\nsudo systemctl disable snapd.socket\nsudo systemctl disable snapd.seeded.service\nsudo snap remove --purge lxd\nsudo snap remove --purge core20\nsudo snap list # this must not list anything else\nsudo apt remove --autoremove snapd\nsudo rm -rf ~/snap /snap /var/snap /var/lib/snapd /root/snap\nThe last command complains about “read-only file system”. So, I had to reboot to stop the systemd services and rerun the command.\nI manually removed snap related systemd services, following this Stackoverflow answer.\ncd /etc/systemd/system\nsudo systemctl stop snap-snapd-18357.mount\nsudo systemctl disable snap-snapd-18357.mount\nsudo rm -f snap-snapd-18357.mount\nsudo systemctl daemon-reload\nsudo systemctl reset-failed\nI did the same thing for all these services:\n- snap-snapd-20092.mount\n- snapd.aa-prompt-listener.service\n- snapd.apparmor.service\n- snapd.autoimport.service\n- snapd.core-fixup.service\n- snapd.seeded.service \n- snapd.snap-repair.timer\n- snapd.service\n- snapd.socket \n- snapd.system-shutdown.service\n- snapd.recovery-chooser-trigger.service\nTo-Do: snapd.seeded.service is still being listed by systemctl list-units -a. How to remove?\nPrevent snap from re-installing. Create the file /etc/apt/preferences.d/nosnap.pref with the following content and save.\nPackage: snapd\nPin: release a=*\nPin-Priority: -10"
  },
  {
    "objectID": "code/2023-09-19-ashwini-setup.html#add-user-for-tasks",
    "href": "code/2023-09-19-ashwini-setup.html#add-user-for-tasks",
    "title": "Setup Ashwini",
    "section": "Add User For Tasks",
    "text": "Add User For Tasks\nuser minion, group minion (not in sudoer list)\nsudo groupadd minion\nsudo usermod -a -G minion banskt\nsudo useradd -g minion -m -c \"User account for webstack\" -s /bin/bash minion\nsudo passwd minion"
  },
  {
    "objectID": "code/2023-09-19-ashwini-setup.html#ssh-security",
    "href": "code/2023-09-19-ashwini-setup.html#ssh-security",
    "title": "Setup Ashwini",
    "section": "SSH Security",
    "text": "SSH Security\n\nSelect a port to change the default SSH Port. Do not choose a port already in use. Ports from 0 to 1023 are reserved and should not be used. Choose a port greater than 1023 and less than 65535. Check using:\n\nss\nss - tulpn\n\nChange the following relevant lines in /etc/ssh/sshd_config\n\n# Change protocol\nProtocol 2\n# \nPort xxxxx\nLogLevel VERBOSE\nPermitRootLogin no\n# trusted hosts are still considered a security risk\nHostbasedAuthentication no\nIgnoreRhosts yes\n# do not allow eavesdropping\nPermitEmptyPasswords no\nAllowTcpForwarding no\nX11Forwarding no\n# last login info can provide available users to hackers\nPrintLastLog no\nSave the file and restart SSH service.\nsudo systemctl restart ssh\nsudo systemctl status ssh\n\nOpen the port in firewall\n\nsudo apt install ufw\nsudo ufw app list\nsudo ufw status verbose\nsudo ufw allow xxxxx/tcp # enter the SSH port here\nsudo ufw enable\nsudo ufw status verbose\n\nSet up ~/.ssh/config and SSH key on the client side.\nCheck if SSH is working!"
  },
  {
    "objectID": "code/2023-09-19-ashwini-setup.html#add-swap-memory",
    "href": "code/2023-09-19-ashwini-setup.html#add-swap-memory",
    "title": "Setup Ashwini",
    "section": "Add Swap Memory",
    "text": "Add Swap Memory\nsudo -i\ndd if=/dev/zero of=/swapfile bs=1024 count=1048576 #1GB: 1024 x 1024 = 1048576\nchmod 0600 /swapfile\nmkswap /swapfile\nswapon /swapfile\necho \"/swapfile none swap sw 0 0\" &gt;&gt; /etc/fstab\nswapon -s\nfree -m"
  },
  {
    "objectID": "code/2023-09-19-ashwini-setup.html#mount-hard-disks",
    "href": "code/2023-09-19-ashwini-setup.html#mount-hard-disks",
    "title": "Setup Ashwini",
    "section": "Mount Hard Disks",
    "text": "Mount Hard Disks\n\nCheck existing partitions and harddisks\n\nsudo lsblk\nsudo fdisk -l\nsudo lshw -C disk\n\nPartition using parted.\nCreate entry in etc/fstab. You can check all uuid from ls -lh /dev/disk/by-uuid/ or individually from sudo blkid /dev/sdb1.\n\n# /dev/sdb1 --&gt; /opt\n/dev/disk/by-uuid/xxxx /opt ext4 defaults 0 2\n# /dev/sdb2 --&gt; ~/local\n/dev/disk/by-uuid/xxxx /home/banskt/local ext4 user,rw,suid,dev,exec,auto,async 0 2\n# /dev/sdb3 --&gt; ~/data\n/dev/disk/by-uuid/xxxx /home/banskt/data ext4 user,rw,suid,dev,exec,auto,async 0 2\nThe sequence of options are important. - After mounting you have to change the ownership of the directories, if required. - Reboot and check if the partitions are mounted automatically."
  },
  {
    "objectID": "code/2023-09-19-ashwini-setup.html#bash",
    "href": "code/2023-09-19-ashwini-setup.html#bash",
    "title": "Setup Ashwini",
    "section": "Bash",
    "text": "Bash\nInstall dotfiles from Github. But, I did not want to install everything from .dotfiles. So, I made a dryrun to import the functions and link individual dotfiles.\ngit clone https://github.com/banskt/dotfiles.git ~/.dotfiles\nsource ~/.dotfiles/install dryrun\nDRYRUN=false\nbackup_and_link .bashrc bash/bashrc\nbackup_and_link .vimrc vim/vimrc\nbackup_and_link .vim vim/dotvim\ncp ~/.dotfiles/git/gitconfig ~/.gitconfig\ncp ~/.dotfiles/ssh/config ~/.ssh/\nchmod 600 ~/.ssh/config\nI edited the .ssh/config file and kept configurations for Github and my other servers (vultr and feral). I edited the .gitconfig to include my email. Logout and login for the changes to take effect.\nFinally, create SSH key for Github and add that key to the Github account!\ncd ~/.ssh\nssh-keygen -t ed25519 -f github_key\ngit remote set-url origin git@github.com:banskt/dotfiles.git\ngit remote show origin\nNote: Any custom bash script for this server must go to ~/.custom_dotfiles/bashrc. Common bash scripts go to the ~/.dotfiles.\nTo-Do: Include a server flag for installation."
  },
  {
    "objectID": "code/2023-09-19-ashwini-setup.html#reduce-automatic-network-usage",
    "href": "code/2023-09-19-ashwini-setup.html#reduce-automatic-network-usage",
    "title": "Setup Ashwini",
    "section": "Reduce Automatic Network Usage",
    "text": "Reduce Automatic Network Usage\nThere are some default packages or services that connects to the internet without my consent. AskUbuntu Question."
  },
  {
    "objectID": "code/2023-09-19-ashwini-setup.html#environment-modules",
    "href": "code/2023-09-19-ashwini-setup.html#environment-modules",
    "title": "Setup Ashwini",
    "section": "Environment Modules",
    "text": "Environment Modules\nI love modules to manage my shell environment. For a dedicated server, it may not be necessary, but it helps me to manage versions and updates.\nFirst, install the dependencies.\n# use apt-cache search for the latest version\nsudo apt install tcl8.6-dev \n# dejagnu provides runtest. Only install if you want to run `make test`, skip otherwise\n# without dejagnu, configure produces this --&gt;\n## WARNING: Install `dejagnu' if you want to run the testsuite\nsudo apt install dejagnu \nNote: I have not installed dejagnu.\nNext, install the package.\nwget github.com/cea-hpc/modules/releases/download/v5.3.1/modules-5.3.1.tar.gz\ntar -zxf modules-5.3.1.tar.gz\n./configure --prefix=/opt/modules --modulefilesdir=/opt/modulefiles --with-tcl-ver=8.6\nmake -j 2\nsudo make install\nFinally, configure. Initialize modules in ~/.custom_dotfiles/bashrc:\n# Environment modules\nsource /opt/modules/init/bash\nAlso, put all the example dotfiles in a separate directory:\nsudo mkdir -p /opt/modules/examples\ncd /opt/modulefiles\nsudo mv dot module-git module-info modules null use.own /opt/modules/examples/"
  },
  {
    "objectID": "code/2023-09-19-ashwini-setup.html#lemp-stack-nginx-mysql-php",
    "href": "code/2023-09-19-ashwini-setup.html#lemp-stack-nginx-mysql-php",
    "title": "Setup Ashwini",
    "section": "LEMP Stack (nginx, MySQL, PHP)",
    "text": "LEMP Stack (nginx, MySQL, PHP)\nPreviously, I installed a webstack in Kalindi.\n\nInstall nginx from source\nCompiling nginx from source affords more flexibility than prebuilt packages: I can add particular modules (from nginx or third parties), and apply latest security patches. See official documentation for help.\n1. Install prerequisites.\n\nPCRE2\nIf you want to install PCRE2 from scratch, it can be done as:\nsudo apt install zlib1g-dev libbz2-dev libreadline-dev libedit-dev\nwget github.com/PCRE2Project/pcre2/releases/download/pcre2-10.42/pcre2-10.42.tar.gz\ntar -zxf pcre2-10.42.tar.gz\ncd pcre2-10.42\n./configure --prefix /opt/pcre2/10.42 --enable-unicode --enable-jit --enable-pcre2-16 --enable-pcre2-32 --enable-pcre2grep-libz --enable-pcre2grep-libbz2 --enable-pcre2test-libreadline --disable-static\nmake -j 2\nmake check\nsudo make install\nI preferred to install the library files in the OS:\nsudo apt install libpcre2-dev\nSurprise: pcre3 is older than pcre2. Do not install pcre3.\n\n\nZlib\nsudo apt install zlib1g-dev\n\n\nOpenSSL\nnginx requires libssl-dev package. But before installing anything, I checked the distribution of current OpenSSL package:\nopenssl version -a\nI have version 3.0.2 installed by default. I wanted the latest version and control of OpenSSL, hence I configured myself (see documentation) using the options from Linux from Scratch. Also, run ./Configure LIST to see a list of configuration options.\nwget https://www.openssl.org/source/openssl-3.1.3.tar.gz\ntar -zxf openssl-3.1.3.tar.gz\nmkdir openssl-3.1.3-build\ncd openssl-3.1.3-build/\n../openssl-3.1.3/Configure linux-x86_64 --prefix=/opt/openssl/3.1.3/ zlib-dynamic shared\nmake -j 2\nmake test\nsudo make install\nI created a module file to load/unload the required OpenSSL version easily.\nmodule load openssl/3.1.3\nmodule unload openssl/3.1.3\n2. Install nginx\n\n\nConfigure\nDownload the source files from nginx.org. I used the latest stable release.\nwget https://nginx.org/download/nginx-1.24.0.tar.gz\ntar -zxf nginx-1.24.0.tar.gz\nThere are many configuration options for nginx. I read them in the official docs and in their open source project. Other resources include:\n\nErick T. Hitter discusses compiling nginx with custom OpenSSL support – mirror on waybackmachine.\nStackoverflow: Can’t compile nginx with SSL support, OpenSSL not found\nnginx forum: build nginx with OpenSSL shared library not using the system OpenSSL library but using the shared library in a specific path.\n\nHere are the configuration options I used:\n./configure --prefix=/opt/nginx/1.24.0 --builddir=../nginx-1.24.0-build --with-http_ssl_module --with-pcre --with-http_v2_module --with-http_realip_module --with-http_addition_module --with-http_sub_module --with-http_dav_module --with-http_flv_module --with-http_mp4_module --with-http_gunzip_module --with-http_gzip_static_module --with-http_random_index_module --with-http_secure_link_module --with-http_stub_status_module --with-http_auth_request_module --with-threads --with-stream --with-stream_ssl_module --with-http_slice_module --with-mail --with-mail_ssl_module --with-file-aio --with-cc-opt=\"-I /opt/openssl/3.1.3/include\" --with-ld-opt=\"-L /opt/openssl/3.1.3/lib64 -ldl -Wl,-rpath,/opt/openssl/3.1.3/lib64\"\nHere is the configuration output which may be helpful later:\nConfiguration summary\n  + using threads\n  + using system PCRE2 library\n  + using system OpenSSL library\n  + using system zlib library\n\n  nginx path prefix: \"/opt/nginx/1.24.0\"\n  nginx binary file: \"/opt/nginx/1.24.0/sbin/nginx\"\n  nginx modules path: \"/opt/nginx/1.24.0/modules\"\n  nginx configuration prefix: \"/opt/nginx/1.24.0/conf\"\n  nginx configuration file: \"/opt/nginx/1.24.0/conf/nginx.conf\"\n  nginx pid file: \"/opt/nginx/1.24.0/logs/nginx.pid\"\n  nginx error log file: \"/opt/nginx/1.24.0/logs/error.log\"\n  nginx http access log file: \"/opt/nginx/1.24.0/logs/access.log\"\n  nginx http client request body temporary files: \"client_body_temp\"\n  nginx http proxy temporary files: \"proxy_temp\"\n  nginx http fastcgi temporary files: \"fastcgi_temp\"\n  nginx http uwsgi temporary files: \"uwsgi_temp\"\n  nginx http scgi temporary files: \"scgi_temp\"\n\n\nBuild\nBuild nginx in the new build directory.\nmake -f ../nginx-1.24.0-build/Makefile -j 2\nsudo make -f ../nginx-1.24.0-build/Makefile install\n3. Post-install configuration\nI initially considered using custom ports for HTTP and HTTPS (instead of the default 80 and 443) but I rejected the idea because Let’s Encrypt requires port 80 for generating and renewing certificates. These articles also helped in making the decision:\n\nLet’s Encrypt explains why you should keep port 80 open\nScott Helme argues against closing port 80\n\n\n\nnginx.conf\nModify the configuration file for external access. Here is my initial nginx configuration in /opt/nginx/1.24.0/conf/nginx.conf.\nuser  minion;\nworker_processes  1;\n\nevents {\n    worker_connections  1024;\n}\n\n\nhttp {\n    include       mime.types;\n    default_type  application/octet-stream;\n\n    sendfile        on;\n    keepalive_timeout  65;\n\n    server {\n        listen       80;\n        server_name  127.0.0.1 &lt;ipv4_address&gt;;\n        location / {\n            root   html;\n            index  index.html index.htm;\n        }\n        # redirect server error pages to the static page /50x.html\n        error_page   500 502 503 504  /50x.html;\n        location = /50x.html {\n            root   html;\n        }\n    }\n}\n\n\nOpen port in firewall\nTo register nginx as an ufw application, create a file /etc/ufw/applications.d/nginx. Replace xx with port numbers for HTTP and HTTPS. If you are running nginx as a non-root user, then you have to change the accessible port because the default port 80 is not available to non-root users. Therefore, it’s necessary to use a port &gt; 1000.\n[Nginx HTTP]\ntitle=Web Server (Nginx, HTTP)\ndescription=Small, but very powerful and efficient web server\nports=80/tcp\n\n[Nginx HTTPS]\ntitle=Web Server (Nginx, HTTPS)\ndescription=Small, but very powerful and efficient web server\nports=443/tcp\n\n[Nginx Full]\ntitle=Web Server (Nginx, HTTP + HTTPS)\ndescription=Small, but very powerful and efficient web server\nports=80,443/tcp\nCheck the registered app and allow nginx HTTP.\nsudo ufw app info 'Nginx HTTP'\nsudo ufw allow 'Nginx HTTP'\nLog files should be accessible by the user minion.\nchown -R root:minion /opt/nginx/1.24.0/logs\nchown minion:minion /opt/nginx/1.24.0/logs/access.log\nchown minion:minion /opt/nginx/1.24.0/logs/error.log\nchmod 775 /opt/nginx/1.24.0/logs\n\n\nUseful commands\nCheck nginx configuration and start nginx.\n# check configuration\nsudo /opt/nginx/1.24.0/sbin/nginx -t\n# start\nsudo /opt/nginx/1.24.0/sbin/nginx\n# stop\nsudo /opt/nginx/1.24.0/sbin/nginx -s stop\n# restart\nsudo /opt/nginx/1.24.0/sbin/nginx -s reload\n\n\nsystemd\nCreate a systemd service file to control nginx using systemctl as described in the official documentation. In Ubuntu 22.04, the file is /lib/systemd/system/nginx.service.\n[Unit]\nDescription=The NGINX HTTP and reverse proxy server\nAfter=syslog.target network-online.target remote-fs.target nss-lookup.target\nWants=network-online.target\n\n[Service]\nType=forking\nPIDFile=/opt/nginx/1.24.0/logs/nginx.pid\nExecStartPre=/opt/nginx/1.24.0/sbin/nginx -t\nExecStart=/opt/nginx/1.24.0/sbin/nginx\nExecReload=/opt/nginx/1.24.0/sbin/nginx -s reload\nExecStop=/bin/kill -s QUIT $MAINPID\nPrivateTmp=true\n\n[Install]\nWantedBy=multi-user.target\nNow, I can use systemctl commands to control nginx.\nsudo systemctl status nginx\nsudo systemctl start nginx\nsudo systemctl stop nginx\nsudo systemctl restart nginx\n\n\nCheck\nFire up the browser and check both links:\n\nhttp://127.0.0.1\nhttp://&lt;ipv4_address&gt;\n\nIf you are installing on the server and you do not have access to the localhost (127.0.0.1) of the remote server, then you can ssh-tunnel to the remote server from your local machine. For example, I defined ashwini in ssh/config of the local machine and installed ssh-localportfwd from here.\nssh-localportfwd open ashwini 80 &lt;local_port&gt;\nThen, I can access the localhost of the remote machine using http://127.0.0.1:xx where xx is the local_port of my local machine through which I tunneled. The second IPv4 address should work from external network.\nThe SSL connection will still not work. Do not worry yet.\n\n\nModular control\nOnce everything was working, I removed the external IP from the base configuration of nginx and created server configurations in ~/local/.nginx/sites-available/ For example, here is my 000-default-server.conf:\nserver {\n    listen      80 default_server;\n    server_name &lt;ipv4_address&gt;;\n    location / {\n        root        /path/to/webdata/base;\n        index       index.html index.htm;\n    }\n    # redirect server error pages to the static page /50x.html\n    error_page   500 502 503 504  /50x.html;\n    location = /50x.html {\n        root        /path/to/webdata/base;\n    }\n\n    # produce a directory listing using ngx_http_autoindex_module \n    autoindex            on;\n    autoindex_exact_size off;\n    autoindex_localtime  on;\n\n    # Deny access to anything starting with .ht\n    location ~ /\\.ht {\n        deny  all;\n    }\n}\nI added the following line to /opt/nginx/1.24.0/conf/nginx.conf:\ninclude /home/banskt/local/.nginx/sites-enabled/*\nAnd then created the sites-enabled directory:\nmkdir -p ~/local/.nginx/sites-enabled\ncd ~/local/.nginx/sites-enabled\nln -s /home/banskt/local/.nginx/sites-available/000-default-server.conf ./default\nThis way, I can manage adding domains, sub-domains, sub-directories on my server directly from my sites-available and sites-enabled directories.\nAt this point, 127.0.0.1 should serve the nginx welcome message and &lt;ipv4_address&gt; should serve the HTML files from /path/to/webdata/base. Again, check they are working with ssh-localportfwd.\n\n\n\nLink domain name\nI had purchased several domain names. Now, it is time to put one of them to use. You can skip this step and access the server using IPv4 address instead.\n\nLogin to namesilo.com\nManage DNS\nUse default nameservers of namesilo.com\nChange A record pointing to the VPS IPv4 address. You can point different subdomains to different IP addresses. If you want to point every subdomain to the same IP, you can use an asterisk (*) as your subdomain.\nUpdate nginx.conf, change IPv4 address to mydomain.com.\n\n\nAlias www to non-www\nI want to redirect all traffic from www to non-www. Easiest way is to define an A entry for www.mydomain.com and use 301 redirect from nginx configuration. However, when my IP changes then I have to change the A record for both mydomain.com and www.mydomain.com. Another solution is to use CNAME entry in the DNS zone file and redirect in the server nginx configuration. Both of them are required as explained in this Stackoverflow answer.\n\nA CNAME record does not function the same way as a URL redirect. A CNAME record directs web traffic for a particular domain to the target domain’s IP address. Once the visitor reaches that IP address, the web server’s configuration will determine how the domain is handled. If that domain is not configured on the server, the server will simply display its default web page (if any). This may or may not be the web page for the target domain in the CNAME record, depending on how the server is configured.\n\n\nAdd CNAME entry in zonefile.\nAdd 301 redirect in nginx.conf\n\nserver {\n    listen      80;\n    server_name www.mydomain.com;\n    return 301 $scheme://mydomain.com$request_uri;\n}\n\n\nCheck DNS\nThere are many DNS lookups, but I like intoDNS.\n\n\n\nSSL\nI did not use certbot because it enforced installation using snap.\n\nInstall acme. The options used for the installation are explained in the documentation.\n\ngit clone https://github.com/acmesh-official/acme.sh.git\ncd acme.sh/\n./acme.sh --install --home /home/banskt/local/.acme --accountemail banskt.saikat@gmail.com\nDelete the entry in ~/.bashrc and add it to ~/.custom_dotfiles/bashrc.\n# Source acme.sh for SSL certificates\nsource \"/home/banskt/local/.acme/acme.sh.env\"\nAfter sourcing, acme.sh will be available on commandline. Check.\n\nCreate the acme-challenge directory in the document root.\n\ncd /path/to/webdata/base\nmkdir -p .well-known/acme-challenge/\nsudo chown -R minion:minion .well-known\nsudo chmod -R 770 .well-known\nand give permissions according to your setup.\n\nCreate directory to store SSL certificates\n\ncd /home/banskt/local/.nginx/\nmkdir -p ssl/mydomain.com/\n\nGenerate dhparams file\n\ncd /home/banskt/local/.nginx/ssl/\nmodule load openssl/3.1.3\nopenssl dhparam -out dhparams.pem 4096\n\nIssue certificates. Optionally, use DNS API. You can either issue certificate for a single domain,\n\nacme.sh --issue -d foo.mydomain.com -w /path/to/webdata/base -k 4096\nor have multiple domains in the same certificate.\nacme.sh --issue -d mydomain.com -d www.mydomain.com -w /path/to/webdata/base -k 4096\nHere, -w specifies the document root of the website where the acme-challenge is created, -k specifies the domain key length.\n\nGenerate SSL configurations from Mozilla SSL Configuration Generator. Write the configuration in /opt/nginx/1.24.0/conf/ssl_params.conf so that it can be included for all servers. For each server, create the SSL nginx configuration, for example,\n\n  ssl_certificate         /home/banskt/local/.nginx/ssl/sbanerjee.in/fullchain.pem;\n  ssl_certificate_key     /home/banskt/local/.nginx/ssl/sbanerjee.in/privkey.pem;\n  # verify chain of trust of OCSP response using Root CA and Intermediate certs\n  ssl_trusted_certificate /home/banskt/local/.nginx/ssl/sbanerjee.in/fullchain.pem;\n  include                 /opt/nginx/1.24.0/conf/ssl_params.conf;\n\nInstall the issued certificate to nginx server\n\nacme.sh --install-cert -d mydomain.com \\\n  --fullchain-file /home/banskt/local/.nginx/ssl/mydomain.com/fullchain.pem \\\n  --key-file /home/banskt/local/.nginx/ssl/mydomain.com/privkey.pem \\\n  --reloadcmd \"sudo systemctl restart nginx\"\nacme.sh --install-cert -d foo.mydomain.com \\\n  --fullchain-file /home/banskt/local/.nginx/ssl/foo.mydomain.com/fullchain.pem \\\n  --key-file /home/banskt/local/.nginx/ssl/foo.mydomain.com/privkey.pem \\\n  --reloadcmd \"sudo systemctl restart nginx\"\n\nCheck everything is working! Use browser and Qualys SSL server test.\n\nacme.sh --help\nacme.sh --list\n\n\nImprove speed and performance\n\nTuning nginx can improve speed and performance.\nBetter SSL configuration\nLet’s Encrypt without port 80"
  },
  {
    "objectID": "code/2023-04-27-gradvi-setup.html",
    "href": "code/2023-04-27-gradvi-setup.html",
    "title": "Setup GradVI workbench",
    "section": "",
    "text": "Here is a short documentation to setup the environment for running GradVI experiments at the NYGC cluster."
  },
  {
    "objectID": "code/2023-04-27-gradvi-setup.html#install-r-packages",
    "href": "code/2023-04-27-gradvi-setup.html#install-r-packages",
    "title": "Setup GradVI workbench",
    "section": "Install R packages",
    "text": "Install R packages\n\nmr.ash.alpha\n\ndevtools::install_github(\"stephenslab/mr.ash.alpha\")\n\ngenlasso\n\ninstall.packages(\"genlasso\")"
  },
  {
    "objectID": "code/2023-04-27-gradvi-setup.html#install-python-packages",
    "href": "code/2023-04-27-gradvi-setup.html#install-python-packages",
    "title": "Setup GradVI workbench",
    "section": "Install Python packages",
    "text": "Install Python packages\nconda install patsy\n\nGradVI\n\ncd ~/software\ngit clone git@github.com:stephenslab/gradvi.git\ncd gradvi\npip install -e .\n\nmr.ash.pen\n\ncd ~/software\ngit clone git@github.com:banskt/mr-ash-pen.git\ncd mr-ash-pen\npip install .\nI could not install the editable version of the package. I also could not install fpydemo using the -e flag. The normal installation was smooth, but the editable version failed while trying to link the same file multiple times. I ran out of time for debugging, but this needs to be solved later."
  },
  {
    "objectID": "code/2023-04-27-gradvi-setup.html#install-dsc",
    "href": "code/2023-04-27-gradvi-setup.html#install-dsc",
    "title": "Setup GradVI workbench",
    "section": "Install DSC",
    "text": "Install DSC\n\nPrerequisites that can be installed with conda\n\nconda install networkx sympy pyarrow sqlalchemy\nconda install h5py sos sos-pbs\n\nInstall DSC\n\ngit clone git@github.com:stephenslab/dsc.git\ncd dsc\npip install .\nOutput:\nSuccessfully built dsc msgpack-python PTable\nInstalling collected packages: PTable, msgpack-python, numexpr, dsc\nSuccessfully installed PTable-0.9.2 dsc-0.4.3.5 msgpack-python-0.5.6 numexpr-2.8.4\n\nCheck installation\n\ndsc --version\ndsc-query --version\n\nInstall R utilities for DSC\n\nsetwd(\"/gpfs/commons/home/sbanerjee/software/dsc/dscrutils\")\ngetwd()\ndevtools::install_local('.')\nsystem(\"dsc-query --version\")"
  }
]